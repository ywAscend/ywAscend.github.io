<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>芸伟</title>
  
  <subtitle>与其临渊羡鱼，不如退而结网</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://github.com/ywAscend/"/>
  <updated>2021-05-20T14:32:35.782Z</updated>
  <id>https://github.com/ywAscend/</id>
  
  <author>
    <name>ywAscend</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>数组常用方法</title>
    <link href="https://github.com/ywAscend/2021/05/20/%E6%95%B0%E7%BB%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <id>https://github.com/ywAscend/2021/05/20/%E6%95%B0%E7%BB%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/</id>
    <published>2021-05-20T14:31:54.000Z</published>
    <updated>2021-05-20T14:32:35.782Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h5 id="访问方法："><a href="#访问方法：" class="headerlink" title="访问方法："></a>访问方法：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">push  添加元素到数组末尾。改变原数组，返回数组长度</span><br></pre></td></tr></table></figure><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop   删除数组最后一个元素。改变原数组，返回删除的元素。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shift 删除数组第一个元素。改变原数组，返回删除的元素。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unshift  添加元素到数组头部。改变原数组，返回数组的长度。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">indexOf  找出某个元素在数组中第一次出现的位置，没有返回-1。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">splice  </span><br><span class="line">删除数组中的元素。接收三个参数，第一个是删除的起始位置，第二个为要删除的长度，从起始位置算起。第三个为要添加的元素，可用一个或多个值来替换那些被删除的元素改变原数组，返回一个包含删除元素的新数组。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slice  接收两个参数，start,end。 不改变原数组。返回一个新的数组，包含从start到end(不包含该元素)的数组中元素。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">contact   返回一个由当前数组和其他若干个数组组合的新数组。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">includes  判断数组中是否包含指定的值，包含返回true,否则返回false。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">join      连接所有数组中的元素组成一个字符串。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">toString  返回一个由所有数组元素组合而成的字符串。</span><br><span class="line">  遮蔽了原型链上的Object.prototype.toString() 方法。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lastIndexOf  返回数组中最后与指定值相等的元素的索引，找不到返回-1。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort  排序，返回排序后的数组。改变原数组。</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reverse  颠倒数组中元素的排列顺序,返回颠倒后的数组。改变原数组。</span><br></pre></td></tr></table></figure><h5 id="迭代方法"><a href="#迭代方法" class="headerlink" title="迭代方法"></a>迭代方法</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">forEach为数组中的每个元素执行一次回调函数</span><br><span class="line">entries返回一个数组迭代器对象，该迭代器会包含所有数组元素的键值对。</span><br><span class="line">every如果数组中的每个元素都满足测试函数，则返回 true，否则返回 false。</span><br><span class="line">some如果数组中至少有一个元素满足测试函数，则返回 true，否则返回 false。</span><br><span class="line">filter将所有在过滤函数中返回 true 的数组元素放进一个新数组中并返回。</span><br><span class="line">find找到第一个满足测试函数的元素并返回那个元素的值，如果找不到，则返回 undefined。</span><br><span class="line">findIndex找到第一个满足测试函数的元素并返回那个元素的索引，如果找不到，则返回 -1。</span><br><span class="line">keys方法返回一个包含数组中每个索引键的Array Iterator对象。</span><br><span class="line">map返回一个由回调函数的返回值组成的新数组。</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;h3 id=&quot;数组&quot;&gt;&lt;a href=&quot;#数组&quot; class=&quot;headerlink&quot; title=&quot;数组&quot;&gt;&lt;/a&gt;数组&lt;/h3&gt;&lt;h5 id=&quot;访问方法：&quot;&gt;&lt;a href=&quot;#访问方法：&quot; class=&quot;headerlink&quot; title=&quot;访问方法：&quot;&gt;&lt;/a&gt;访问方法：&lt;/h5&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;push  添加元素到数组末尾。改变原数组，返回数组长度&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>深拷贝浅拷贝</title>
    <link href="https://github.com/ywAscend/2021/05/20/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E6%B5%85%E6%8B%B7%E8%B4%9D/"/>
    <id>https://github.com/ywAscend/2021/05/20/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E6%B5%85%E6%8B%B7%E8%B4%9D/</id>
    <published>2021-05-20T14:25:35.000Z</published>
    <updated>2021-05-20T14:31:16.873Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><ol><li>概念：</li></ol><p>浅拷贝： 拷贝了指针的指向，当一个对象的值改变会影响另一个对象的值。</p><a id="more"></a><p>深拷贝：拷贝了真正的值，二者互相独立，互不干扰。</p><h5 id="对于数据的拷贝，关键在于要拷贝的数据类类型。"><a href="#对于数据的拷贝，关键在于要拷贝的数据类类型。" class="headerlink" title="对于数据的拷贝，关键在于要拷贝的数据类类型。"></a>对于数据的拷贝，关键在于要拷贝的数据类类型。</h5><ol start="2"><li>js中的数据类型</li></ol><p>js中主要存在基本数据类型和引用类型 两种数据类型</p><p>基本数据类型： string、number、undefined、null、boolean、symbol<br>引用类数据类型： Object 、Array 、Date、Function</p><p>基本类型值保存在栈空间，我们通过按值来访问的。<br>引用类型，的值是对象，栈内存中存放地址指向堆内存中的对象。是按引用访问的。<br>栈内存中存放的只是该对象的访问地址，在堆内存中为这个值分配空间。</p><ol start="3"><li>拷贝的数据类型</li></ol><p>​所有深浅拷贝讨论的是 引用类型数据。</p><p>​浅拷贝的方法有4种： slice、contact、赋值、遍历<br>​其中对于一维数组 slice 、contact是深拷贝。</p><p>​深拷贝的方法：</p><p>​1) 一维数组的 contact 、 slice</p><p>​2) 数组和对象的 JSON.parse(JSON.stringify())</p><p>​3) 解构赋值法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let a1 = [1,2,3]</span><br><span class="line">let a2 = [...a1]</span><br><span class="line">let [...a3] = a2</span><br></pre></td></tr></table></figure><p>4) 遍历法</p><p>目前理解的是 循环遍历对象的key,并判断对象下的key是不是引用类型数据，若不是直接赋值（相当于基本数据赋值），若不是递归遍历，直到所有的数据都是 基本类型数据赋值，这样拷贝下来的数据就是深拷贝。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const deepCopy = obj =&gt; &#123;</span><br><span class="line">if(typeof obj !== &apos;object&apos;) return</span><br><span class="line">let newObj = obj instanceof Array ? [] : &#123;&#125;</span><br><span class="line">for(let key in obj)&#123;</span><br><span class="line">if(obj.hasOwnPerporty(key))&#123;</span><br><span class="line">newOje[key] = typeof obj[key] === &apos;object&apos; ? deepCopy(obj[key]):obj[key]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">return newObj</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;ol&gt;
&lt;li&gt;概念：&lt;/li&gt;
&lt;/ol&gt;&lt;p&gt;浅拷贝： 拷贝了指针的指向，当一个对象的值改变会影响另一个对象的值。&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Js执行机制</title>
    <link href="https://github.com/ywAscend/2021/05/20/Js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/"/>
    <id>https://github.com/ywAscend/2021/05/20/Js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6/</id>
    <published>2021-05-20T14:15:02.000Z</published>
    <updated>2021-05-20T14:23:58.862Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>首先判断js是同步还是异步，同步就进入主线程，异步就进入event table</p><a id="more"></a><p>异步任务在event table中注册函数，当满足触发条件后，被推入event queue(事件队列)</p><p>同步任务进入主线程后一直执行，直到主线程空闲时，才回去event queue中查看是否有可执行的异步任务</p><p>如果有就推入主线程中</p><p>以上三步循环执行，这就是事件循环（event loop）</p><p>准确划分方式是：</p><p>macro-task（宏任务）： 包括整体代码script、setTimeout、setInterval、setImmediate、ajax、dom操作</p><p>micro-task（微任务）：Promsie、process.nextTick</p><p>执行一个宏任务,过程中如果遇到微任务,就将其放到微任务的【事件队列】里<br>当前宏任务执行完成后,会查看微任务的【事件队列】,并将里面全部的微任务依次执行完<br>重复以上2步骤,结合event loop(1) event loop(2) ,就是更为准确的JS执行机制了。</p><h5 id="setTimeout"><a href="#setTimeout" class="headerlink" title="setTimeout:"></a>setTimeout:</h5><p>setTimeout(fn,time) 作为定时器在 间隔 time 时间后，执行回调函数fn。这是一般常用用法。但是有时会发现fn并不是等待time时间后才执行，实际上等待的时间会比time要长。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(()=&gt;&#123;</span><br><span class="line">test()</span><br><span class="line">&#125;,2000)</span><br><span class="line">sleep(100000)</span><br></pre></td></tr></table></figure><p>上述代码，在执行时作为宏任务进入主线程。</p><ul><li>setTimeout 的回调 test()，进入事件列表（event table）注册一个事件,此时计时开始。</li><li>开始执行 sleep()函数，但是sleep()执行的很慢。2s后，test()注册的事件，分发入事件队列中。但此时sleep()仍未执行完。所以2s后 test()并不会执行，在等待 sleep()执行完。</li><li>sleep()最终执行完，test()才从 event queue中进入主线程执行。</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setTimeout这个函数，是经过指定时间后，把要执行的任务(test())加入到Event Queue中，又因为是单线程任务要一个一个执行，如果前面的任务需要的时间太久，那么只能等着，导致真正的延迟时间远远大于2秒。</span><br><span class="line"></span><br><span class="line">又如setTimeout(fn,0) 是指定某个任务在主线程最早可得的空闲时间执行。只要主线程执行栈内的同步任务全部执行完成，栈为空就马上执行，不用在等待多少时间。</span><br></pre></td></tr></table></figure><blockquote><p><code>setTimeout</code>要补充的是，即便主线程为空，0毫秒实际上也是达不到的。根据HTML的标准，最低是4毫秒。</p></blockquote><h5 id="setInterval："><a href="#setInterval：" class="headerlink" title="setInterval："></a>setInterval：</h5><p>与 <strong>setTimeout</strong> 类似，不过<strong>setInterval</strong>是循环的执行。setInterval会每隔指定的时间将注册的函数置入Event Queue，如果前面的任务耗时太久，那么同样需要等待。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">对于setInterval(fn,n)来说，并不是每过n秒会执行一次fn，而是每过ms秒，会有fn进入Event Queue。</span><br><span class="line">一旦setInterval的回调函数fn执行时间超过了延迟时间n，那么就完全看不出来有时间间隔了。</span><br></pre></td></tr></table></figure><h5 id="promise"><a href="#promise" class="headerlink" title="promise"></a>promise</h5><p>一旦实例化就会执行回调，且不可逆。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">new Promise((reslove)=&gt;&#123;</span><br><span class="line">console.log(&apos;100&apos;)</span><br><span class="line">reslove()</span><br><span class="line">setTimeout(()=&gt;&#123;</span><br><span class="line">console.log(&apos;200&apos;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;).then(()=&gt;&#123;</span><br><span class="line">console.log(&apos;300&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">输出： 100、300、200</span><br></pre></td></tr></table></figure><p>执行机制：</p><p><img src="/images/%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6.png" alt></p><ul><li><p>同步和异步任务分别进入不同的执行”场所”，同步的进入主线程，异步的进入Event Table并注册函数。</p></li><li><p>当指定的事情完成时，Event Table会将这个函数移入Event Queue。</p></li><li><p>主线程内的任务执行完毕为空，会去Event Queue读取对应的函数，进入主线程执行。</p></li><li><p>上述过程会不断重复，也就是常说的Event Loop(事件循环)。</p></li></ul><blockquote><p>那怎么知道主线程执行栈为空？js引擎存在monitoring process进程，会持续不断的检查主线程执行栈是否为空，一旦为空，就会去Event Queue那里检查是否有等待被调用的函数。</p></blockquote><p>事件循环：<img src="/images/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF.png" alt="事件循环"></p><blockquote><p>进入整体代码(宏任务)后，开始第一次循环。接着执行所有的微任务。然后再次从宏任务开始，找到其中一个任务队列执行完毕，再执行所有的微任务。</p></blockquote><p>如以下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">setTimeout(function() &#123;</span><br><span class="line">    console.log(&apos;setTimeout&apos;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">new Promise(function(resolve) &#123;</span><br><span class="line">    console.log(&apos;promise&apos;);</span><br><span class="line">    resolve()</span><br><span class="line">&#125;).then(function() &#123;</span><br><span class="line">    console.log(&apos;then&apos;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">console.log(&apos;11&apos;);</span><br></pre></td></tr></table></figure><p>分析：</p><ul><li>这段代码作为宏任务，进入主线程。</li><li>先遇到<code>setTimeout</code>，那么将其回调函数注册后分发到宏任务Event Queue。</li><li>接下来遇到了<code>Promise</code>，<code>new Promise</code>立即执行，<code>then</code>函数分发到微任务Event Queue。</li><li>遇到<code>console.log()</code>，立即执行。</li><li>整体代码script作为第一个宏任务执行结束，看看有哪些微任务？我们发现了<code>then</code>在微任务Event Queue里面，执行。</li><li>ok，第一轮事件循环结束了，我们开始第二轮循环，当然要从宏任务Event Queue开始。我们发现了宏任务Event Queue中<code>setTimeout</code>对应的回调函数，立即执行。</li><li>结束。</li></ul><p>输出：promise 、11、then、setTimeout</p><p>应用：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;1&apos;);</span><br><span class="line"></span><br><span class="line">setTimeout(function() &#123;</span><br><span class="line">    console.log(&apos;2&apos;);</span><br><span class="line">    process.nextTick(function() &#123;</span><br><span class="line">        console.log(&apos;3&apos;);</span><br><span class="line">    &#125;)</span><br><span class="line">    new Promise(function(resolve) &#123;</span><br><span class="line">        console.log(&apos;4&apos;);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(function() &#123;</span><br><span class="line">        console.log(&apos;5&apos;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">process.nextTick(function() &#123;</span><br><span class="line">    console.log(&apos;6&apos;);</span><br><span class="line">&#125;)</span><br><span class="line">new Promise(function(resolve) &#123;</span><br><span class="line">    console.log(&apos;7&apos;);</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(function() &#123;</span><br><span class="line">    console.log(&apos;8&apos;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(function() &#123;</span><br><span class="line">    console.log(&apos;9&apos;);</span><br><span class="line">    process.nextTick(function() &#123;</span><br><span class="line">        console.log(&apos;10&apos;);</span><br><span class="line">    &#125;)</span><br><span class="line">    new Promise(function(resolve) &#123;</span><br><span class="line">        console.log(&apos;11&apos;);</span><br><span class="line">        resolve();</span><br><span class="line">    &#125;).then(function() &#123;</span><br><span class="line">        console.log(&apos;12&apos;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>分析：</p><p>1.第一轮事件循环：</p><ul><li>整体作为宏任务进入主线程，遇到console.log(‘1’) 输出1</li><li>遇到setTimeout ，其回调被分发到宏任务的 event queue中，暂记为 setTimeout1。</li><li>遇到process.nextTick(), 其回调被分发到 微任务的 event queue中，暂记为 process1.</li><li>遇到new Promsie()， Promise一旦实例化就会被执行，此时先输出 7。然后then 被分发到微任务 event queue中，暂记为 then1.</li><li>遇到 setTimeout，其回调被分发到宏任务的 event queue中，暂记为 setTimeout2。</li></ul><p>第一轮事件循环宏任务结束，情况如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出： 1,7</span><br></pre></td></tr></table></figure><p>宏任务队列：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setTimeout1</span><br><span class="line">setTimeout2</span><br></pre></td></tr></table></figure><p>微任务队列：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">process1</span><br><span class="line">then1</span><br></pre></td></tr></table></figure><p>发现有两个微任务，执行这两个微任务。</p><p>输出：6、8</p><h5 id="第一轮事件循环正式结束："><a href="#第一轮事件循环正式结束：" class="headerlink" title="第一轮事件循环正式结束："></a>第一轮事件循环正式结束：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出：1,7,6,8</span><br></pre></td></tr></table></figure><p>此时事件队列中剩余的任务：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">宏任务： setTimeout1、setTimeout2</span><br></pre></td></tr></table></figure><p>2.第二轮事件循环</p><ul><li>第二论事件循环从宏任务setTimeout1开始。</li><li>遇到console.log(‘2’)，输出 2。</li><li>遇到process.nextTick，同样将回调分发到微任务 event queue中，暂记为 process2。</li><li>遇到 new Promise(),先输出 4 ，然后 then 被分发到 微任务 event queue中，暂时记为 then2。</li></ul><p>此时第二轮宏任务循环结束：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出： 2,4</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">宏任务queue： setTimeout2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">微任务queue：process2、then2</span><br></pre></td></tr></table></figure><p>执行微任务队列中所有的微任务：</p><ul><li>执行process2, 输出 3</li><li>执行then2，输出 5</li></ul><h5 id="第二轮事件循环正式结束："><a href="#第二轮事件循环正式结束：" class="headerlink" title="第二轮事件循环正式结束："></a>第二轮事件循环正式结束：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出：2,4,3,5</span><br></pre></td></tr></table></figure><p>此时事件队列中剩余的任务：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">宏任务： setTimeout2</span><br></pre></td></tr></table></figure><p>3.第三轮事件循环</p><ul><li>第三轮事件循环是从宏任务 setTimeout2开始。</li><li>遇到console.log(‘9’)，输出 9。</li><li>遇到process.nextTick（），其回调注册被分发到 微任务 event queue中，暂记为 process3。</li><li>遇到new promise()，输出 11 。 其 then 被分发到 微任务 event queue中，暂记为 then3。</li></ul><p>此时第三轮宏任务循环结束：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出：9,11</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">微任务： process3、then3</span><br></pre></td></tr></table></figure><p>执行此时微任务队列中的所有微任务：</p><ul><li>执行 process3，输出 10。</li><li>执行then3，输出 12。</li></ul><h5 id="第三轮事件循环正式结束："><a href="#第三轮事件循环正式结束：" class="headerlink" title="第三轮事件循环正式结束："></a>第三轮事件循环正式结束：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输出： 9,11,10,12</span><br></pre></td></tr></table></figure><h5 id="至此所有事件执行完毕，各轮事件循环输出如下："><a href="#至此所有事件执行完毕，各轮事件循环输出如下：" class="headerlink" title="至此所有事件执行完毕，各轮事件循环输出如下："></a>至此所有事件执行完毕，各轮事件循环输出如下：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">第一轮事件循环输出：1,7,6,8</span><br><span class="line">第二轮事件循环输出：2,4,3,5</span><br><span class="line">第三轮事件循环输出：9,11,10,12</span><br></pre></td></tr></table></figure><p>最终输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1,7,6,8,2,4,3,5,9,11,10,12</span><br></pre></td></tr></table></figure><p>参考：<a href="https://cloud.tencent.com/developer/article/1369094?from=article.detail.1372207" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1369094?from=article.detail.1372207</a></p>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;首先判断js是同步还是异步，同步就进入主线程，异步就进入event table&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>tree-shaking</title>
    <link href="https://github.com/ywAscend/2020/05/27/tree-shaking/"/>
    <id>https://github.com/ywAscend/2020/05/27/tree-shaking/</id>
    <published>2020-05-27T05:33:31.000Z</published>
    <updated>2020-06-06T14:56:29.719Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>tree shaking 所谓的“摇树”，是指删除无用的代码，这样在构建大型应用时，可以大大减少打包的体积</p><a id="more"></a><h3 id="使用条件"><a href="#使用条件" class="headerlink" title="使用条件"></a>使用条件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 必须使用es6模块 </span><br><span class="line">2. 开启production环境</span><br><span class="line">3. 在package.json中配置</span><br></pre></td></tr></table></figure><h4 id="1-必须使用es6模块"><a href="#1-必须使用es6模块" class="headerlink" title="1.必须使用es6模块"></a>1.必须使用es6模块</h4><p>必须遵循 ES6 的模块规范 (import &amp; export)，如果是 CommonJS 规范 (require) 则无法使用。只打包某一模块中被使用的代码。</p><ul><li>模块a.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export const add (x,y) =&gt; x+y</span><br><span class="line"></span><br><span class="line">const test = () =&gt; &#123;</span><br><span class="line">    consle.log(&apos;print test&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>模块b.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#123;add&#125; from &apos;./a.js&apos;</span><br><span class="line">add()</span><br></pre></td></tr></table></figure></li><li>入口文件：index.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import &apos;./b.js&apos;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure></li></ul><p>最终webpack在打包时，只会打包 a 模块中被用到的 add 相关的代码块</p><h4 id="2-开启production"><a href="#2-开启production" class="headerlink" title="2.开启production"></a>2.开启production</h4><p>生产环境下会自动开启</p><h4 id="3-package-json中配置-sildeEffects"><a href="#3-package-json中配置-sildeEffects" class="headerlink" title="3. package.json中配置 sildeEffects"></a>3. package.json中配置 sildeEffects</h4><p>sideEffects是webpack4新增的一个特性，通过给package.json加入sideEffects:false声明该模块是否含有副作用，为tree-shaking 提供更大的优化空间。</p><p>什么是副作用？</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//test.js</span><br><span class="line">export function test (t) &#123; return t &#125;</span><br><span class="line">console.log(test(6))</span><br></pre></td></tr></table></figure><p>tree-shaking后test模块变为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">console.log( function (t)  &#123; return v &#125;(6) )</span><br></pre></td></tr></table></figure><p>这样 test 模块导出被忽略，但是副作用代码被保留，很多即使经过 tree shaking ，然而 bundle size 还是没有明显的减小。而通常我们期望的是 test 模块既然不被使用了，其中所有的代码应该不被引入才对。<br>这时就需要用到 sideEffects了。如果被引入的 包/模块 被标记为 sideEffects: false 了，那么不管它是否真的有副作用，只要它没有被引用到，整个 模块/包 都会被完整的移除。</p><p>在package.json中配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;sideEffects&quot;:false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们配置了 “sideEffects”: false ，代表所有代码都没有副作用（都可以进行tree shaking）。<br>但是这还有个问题：可能会把css / @babel/polyfill （副作用）文件干掉</p><p>那么我们只需要为指定的文件配置sideEffects即可，修改sileEffects中的配置为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;sideEffects&quot;:[&quot;*.css&quot;] //.css文件具有副作用，tree-shaking时不被错误删除</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="开发环境使用-tree-shaking"><a href="#开发环境使用-tree-shaking" class="headerlink" title="开发环境使用 tree-shaking"></a>开发环境使用 tree-shaking</h3><p>在webpack配置中加入以下配置即可：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    optimization:&#123;</span><br><span class="line">        usedExports: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;tree shaking 所谓的“摇树”，是指删除无用的代码，这样在构建大型应用时，可以大大减少打包的体积&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>缓存</title>
    <link href="https://github.com/ywAscend/2020/05/22/%E7%BC%93%E5%AD%98/"/>
    <id>https://github.com/ywAscend/2020/05/22/%E7%BC%93%E5%AD%98/</id>
    <published>2020-05-22T07:41:17.000Z</published>
    <updated>2020-06-06T14:55:54.824Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>缓存优化：<br>webpack缓存有 babel缓存和文件资源缓存两种。</p><a id="more"></a><h3 id="1-babel缓存"><a href="#1-babel缓存" class="headerlink" title="1. babel缓存"></a>1. babel缓存</h3><ul><li>babel缓存让第二次打包构建速度更快</li></ul><p>开启bebel缓存:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//babel-loader options中配置 cacheDirectory:true</span><br><span class="line">const confg = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                loader:&apos;babel-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    [</span><br><span class="line">                        &quot;@babel/preset-env&quot;,</span><br><span class="line">                        &#123;</span><br><span class="line">                            useBuiltIns:&apos;usage&apos;,</span><br><span class="line">                            corejs: 3,</span><br><span class="line">                            targets:&#123; </span><br><span class="line">                                //指定兼容到哪个版本</span><br><span class="line">                                &quot;chrome&quot;:&quot;60&quot;,</span><br><span class="line">                                &quot;firefox&quot;:&quot;60&quot;,</span><br><span class="line">                                &quot;ie&quot;:&quot;9&quot;,</span><br><span class="line">                                &quot;safari&quot;:&quot;10&quot;,</span><br><span class="line">                                &quot;edge&quot;:&quot;11&quot;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    //开启babel缓存</span><br><span class="line">                    //第二次构建时，会读取之前的缓存</span><br><span class="line">                    cacheDirectory: true</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-文件资源缓存"><a href="#2-文件资源缓存" class="headerlink" title="2. 文件资源缓存"></a>2. 文件资源缓存</h3><ul><li><p>hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hash： 每次webpack构建时会生成一个唯一的hash值</span><br><span class="line">问题： 因为js和css同时使用一个hash值</span><br><span class="line">如果重新打包，会导致所有缓存失效（可能只改动一个文件）</span><br></pre></td></tr></table></figure></li><li><p>chunkhash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chunkhash: 根据chunk生成的hash值，如果打包来源于同一个chunk,那么hash值就一样</span><br><span class="line">问题：js和css的hash值还是一样</span><br><span class="line">      因为css是在js中被引进入的，多以同属于同一个chunk</span><br><span class="line">什么是chunk？ </span><br><span class="line">    以一个入口文件 index.js,引入其他依赖（js|css）,这些依赖会跟入口文件形成一个文件，</span><br><span class="line">    这一个文件就叫做chunk，也叫代码块。所有根据入口文件引入东西都会生成一个chunk</span><br></pre></td></tr></table></figure></li><li><p>contenthash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">contenthash: 根据文件的内容生成hash值。不同文件hash值一定不一样</span><br><span class="line">--&gt; 让代码上线运行缓存更好使用</span><br></pre></td></tr></table></figure></li></ul><h3 id="配置服务："><a href="#配置服务：" class="headerlink" title="配置服务："></a>配置服务：</h3><h3 id="1-server-js-会使用build文件下缓存"><a href="#1-server-js-会使用build文件下缓存" class="headerlink" title="1. server.js  会使用build文件下缓存"></a>1. server.js  会使用build文件下缓存</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 服务器代码</span><br><span class="line"> * 启动服务器指令：</span><br><span class="line"> * npm i nodemon -g</span><br><span class="line"> * nodemon server.js</span><br><span class="line"> * </span><br><span class="line"> * node server.js</span><br><span class="line"> * </span><br><span class="line"> * 访问服务器地址：</span><br><span class="line"> * http://localhost:3000</span><br><span class="line"> * </span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"> const express = require(&apos;express&apos;)</span><br><span class="line"></span><br><span class="line"> const app = express()</span><br><span class="line"></span><br><span class="line"> app.use(express.static(&apos;build&apos;,&#123; maxAge:1000*3600 &#125;))</span><br><span class="line"></span><br><span class="line"> app.listen(3000)</span><br></pre></td></tr></table></figure><h3 id="2-webpack-congfig-js"><a href="#2-webpack-congfig-js" class="headerlink" title="2. webpack.congfig.js"></a>2. webpack.congfig.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">//css抽取为单独文件</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;)</span><br><span class="line">//css压缩</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin = require(&apos;optimize-css-assets-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">//process.env.NODE_ENV = &apos;development&apos;</span><br><span class="line">process.env.NODE_ENV = &apos;prodution&apos;</span><br><span class="line"></span><br><span class="line">const commonCssConfig = [</span><br><span class="line">    MiniCssExtractPlugin.loader,</span><br><span class="line">    &apos;css-loader&apos;,</span><br><span class="line">    //css兼容</span><br><span class="line">    &#123;</span><br><span class="line">        loader:&apos;postcss-loader&apos;,</span><br><span class="line">        options:&#123;</span><br><span class="line">            indent: &apos;postcss&apos;,</span><br><span class="line">            plugins:()=&gt;[</span><br><span class="line">                require(&apos;postcss-preset-env&apos;)()   // package.json需配置 &apos;browserslist&apos;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &apos;./src/js/index.js&apos;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename:&apos;js/built.[contenthash:10].js&apos;,</span><br><span class="line">        path: Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">          //js处理</span><br><span class="line">          &#123;</span><br><span class="line">            test: /\.js$/, //js语法检查 eslint --&gt;eslint-loader eslint-config-airbnb-base - eslint-plugin-import</span><br><span class="line">            exclude:/node_modules/,</span><br><span class="line">            enforce: &apos;pre&apos;,</span><br><span class="line">            loader:&apos;eslint-loader&apos;, //package.json 配置 &quot;eslintConfig&quot;: &#123;&quot;extends&quot;:&quot;airbnb-base&quot;&#125;</span><br><span class="line">            options:&#123;</span><br><span class="line">                fix:true //自动修复</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            //以下loader只会匹配一个</span><br><span class="line">            //注意不能有两个配置处理同一种类型文件，所以将eslint-loader拿到外层</span><br><span class="line">            //优化生产环境打包速度</span><br><span class="line">            oneOf:[</span><br><span class="line">                    /**</span><br><span class="line">                     * 正常来讲，一个文件只能被一个loader处理</span><br><span class="line">                     * 当一个文件要被多个loader处理，那么一定要指定loader执行的先后顺序</span><br><span class="line">                     * 先执行 esLint 再执行babel</span><br><span class="line">                     */</span><br><span class="line">                    &#123;   //js兼容</span><br><span class="line">                        test:/\.js$/, // babel: babel-loader--&gt;@babel/core--&gt;@babel/preset-env -- core-js --&gt;@babel/poly-fill</span><br><span class="line">                        exclude:/node_modules/,</span><br><span class="line">                        loader:&apos;babel-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            presets:[</span><br><span class="line">                                [</span><br><span class="line">                                    &quot;@babel/preset-env&quot;,</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        useBuiltIns: &apos;usage&apos;, //按需加载</span><br><span class="line">                                        corejs: 3, //指定corejs版本</span><br><span class="line">                                        targets:&#123; //指定兼容到哪个版本</span><br><span class="line">                                            &quot;chrome&quot;:&quot;60&quot;,</span><br><span class="line">                                            &quot;firefox&quot;:&quot;60&quot;,</span><br><span class="line">                                            &quot;ie&quot;:&quot;9&quot;,</span><br><span class="line">                                            &quot;safari&quot;:&quot;10&quot;,</span><br><span class="line">                                            &quot;edge&quot;:&quot;11&quot;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                ]</span><br><span class="line">                            ],</span><br><span class="line">                            //开启babel缓存</span><br><span class="line">                            //第二次构建时，会读取之前的缓存</span><br><span class="line">                            cacheDirectory: true</span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125;,</span><br><span class="line">                    //css样式</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.css$/,</span><br><span class="line">                        use: [...commonCssConfig]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.less$/,</span><br><span class="line">                        use:[ ...commonCssConfig,&apos;less-loader&apos;]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    //图片</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.(jpg|png|gif)$/,</span><br><span class="line">                        loader:&apos;url-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            limit:8*1024,</span><br><span class="line">                            name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">                            esModule:false,</span><br><span class="line">                            outputPath:&apos;imgs&apos;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.html$/,</span><br><span class="line">                        loader:&apos;html-loader&apos;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    //字体图标</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.(ttf|woff|woff2|svg|eot)$/,</span><br><span class="line">                        loader:&apos;file-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            outputPath:&apos;media&apos;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: process.env.NODE_ENV === &apos;development&apos; ? &apos;development&apos; : &apos;production&apos;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template:&apos;./src/index.html&apos;,</span><br><span class="line">            minify:&#123; //压缩html</span><br><span class="line">                collapseWhitespace:true, //移除空格</span><br><span class="line">                removeComments: true  //移除注释</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: &apos;css/built.[contenthash:10].css&apos; //重命名打包后的css</span><br><span class="line">        &#125;),</span><br><span class="line">        new OptimizeCssAssetsWebpackPlugin() //压缩css</span><br><span class="line">    ],</span><br><span class="line">    devtool:&apos;source-map&apos;,</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: &apos;build&apos;,</span><br><span class="line">        compress:true,</span><br><span class="line">        port:3000,</span><br><span class="line">        open:true,</span><br><span class="line">        hot:true  //开启热加载</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;缓存优化：&lt;br&gt;webpack缓存有 babel缓存和文件资源缓存两种。&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>oneOf</title>
    <link href="https://github.com/ywAscend/2020/05/22/oneOf/"/>
    <id>https://github.com/ywAscend/2020/05/22/oneOf/</id>
    <published>2020-05-22T06:29:17.000Z</published>
    <updated>2020-06-06T14:55:22.385Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>webpack的 module是对一些文件的loader的配置，如：</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.css$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>上述配置正常使用没有问题，但是从性能上考虑，webpack在对 .css|.less 文件进行loader编译时，每个css|less文件都要进行 css和less的loader匹配，当文件非常多的时候，就会造成性能很大的消耗</p><p>那么在webpack中就需要使用 oneOf 对这一块来进行优化。</p><p>很简单，直接在 rules 中添加oneOf就可以了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            oneOf:[</span><br><span class="line">                 //js处理</span><br><span class="line">                    &#123;</span><br><span class="line">                        test: /\.js$/, //js语法检查 eslint --&gt;eslint-loader eslint-config-airbnb-base - eslint-plugin-import</span><br><span class="line">                        exclude:/node_modules/,</span><br><span class="line">                        enforce: &apos;pre&apos;,</span><br><span class="line">                        loader:&apos;eslint-loader&apos;, //package.json 配置 &quot;eslintConfig&quot;: &#123;&quot;extends&quot;:&quot;airbnb-base&quot;&#125;</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            fix:true //自动修复</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;   //js兼容</span><br><span class="line">                        test:/\.js$/, // babel: babel-loader--&gt;@babel/core--&gt;@babel/preset-env -- core-js --&gt;@babel/poly-fill</span><br><span class="line">                        exclude:/node_modules/,</span><br><span class="line">                        loader:&apos;babel-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            presets:[</span><br><span class="line">                                [</span><br><span class="line">                                    &quot;@babel/preset-env&quot;,</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        useBuiltIns: &apos;usage&apos;, //按需加载</span><br><span class="line">                                        corejs: 3, //指定corejs版本</span><br><span class="line">                                        targets:&#123; //指定兼容到哪个版本</span><br><span class="line">                                            &quot;chrome&quot;:&quot;60&quot;,</span><br><span class="line">                                            &quot;firefox&quot;:&quot;60&quot;,</span><br><span class="line">                                            &quot;ie&quot;:&quot;9&quot;,</span><br><span class="line">                                            &quot;safari&quot;:&quot;10&quot;,</span><br><span class="line">                                            &quot;edge&quot;:&quot;11&quot;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                ]</span><br><span class="line">                            ]</span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125;,</span><br><span class="line">                    //css样式</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.css$/,</span><br><span class="line">                        use: [...commonCssConfig]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.less$/,</span><br><span class="line">                        use:[ ...commonCssConfig,&apos;less-loader&apos;]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    //其他</span><br><span class="line">                    ...</span><br><span class="line">            ]</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>在 oneOf下的loader只会匹配一个。</p><ul><li>注意不能有两个配置处理同一种类型文件<br>但 上述js有连个loader，怎么解决这个问题呢？</li></ul><p>正常来讲，一个文件只能被一个loader处理,当一个文件要被多个loader处理，那么一定要指定loader执行的先后顺序,先执行 esLint 再执行babel.这里需要将eslint-loader拿到外层，优化生产环境打包速度</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line"></span><br><span class="line">            &#123;</span><br><span class="line">                //js处理</span><br><span class="line">                    &#123;</span><br><span class="line">                        test: /\.js$/, //js语法检查 eslint </span><br><span class="line">                        enforce: &apos;pre&apos;,</span><br><span class="line">                        loader:&apos;eslint-loader&apos;, //package.json 配置 &quot;eslintConfig&quot;: &#123;&quot;extends&quot;:&quot;airbnb-base&quot;&#125;</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            fix:true //自动修复</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            &#123; </span><br><span class="line">              oneOf:[</span><br><span class="line">                    &#123;   //js兼容</span><br><span class="line">                        test:/\.js$/, // babel: babel-loader--&gt;@babel/core--&gt;@babel/preset-env -- core-js --&gt;@babel/poly-fill</span><br><span class="line">                        exclude:/node_modules/,</span><br><span class="line">                        loader:&apos;babel-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            presets:[</span><br><span class="line">                                [</span><br><span class="line">                                    &quot;@babel/preset-env&quot;,</span><br><span class="line">                                    &#123;</span><br><span class="line">                                        useBuiltIns: &apos;usage&apos;, //按需加载</span><br><span class="line">                                        corejs: 3, //指定corejs版本</span><br><span class="line">                                        targets:&#123; //指定兼容到哪个版本</span><br><span class="line">                                            &quot;chrome&quot;:&quot;60&quot;,</span><br><span class="line">                                            &quot;firefox&quot;:&quot;60&quot;,</span><br><span class="line">                                            &quot;ie&quot;:&quot;9&quot;,</span><br><span class="line">                                            &quot;safari&quot;:&quot;10&quot;,</span><br><span class="line">                                            &quot;edge&quot;:&quot;11&quot;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                ]</span><br><span class="line">                            ]</span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125;,</span><br><span class="line">                    //css样式</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.css$/,</span><br><span class="line">                        use: [...commonCssConfig]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        test:/\.less$/,</span><br><span class="line">                        use:[ ...commonCssConfig,&apos;less-loader&apos;]</span><br><span class="line">                    &#125;,</span><br><span class="line">                    //其他</span><br><span class="line">                    ...</span><br><span class="line">            &#125;   ]</span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;webpack的 module是对一些文件的loader的配置，如：&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>source-map</title>
    <link href="https://github.com/ywAscend/2020/05/21/source-map/"/>
    <id>https://github.com/ywAscend/2020/05/21/source-map/</id>
    <published>2020-05-21T01:39:24.000Z</published>
    <updated>2020-06-06T14:54:11.269Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>source-map ： 一种提供 源代码 到 构建后代码 映射的技术，如果构建后代码出错了，通过映射可以追踪源代码错误，便于问题定位，开发调试</p><a id="more"></a><ul><li>开启source-map<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    devtool: &apos;source-map&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure></li></ul><p>打开控制台，运行webpack：<br><img src="https://i.loli.net/2020/06/06/vm1M7NViRhO4Ppn.png" alt="运行结果"></p><p>打包后的文件生成了 .map 文件</p><p>修改 devtool的值为 inline-source-map</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    devtool: &apos;inline-source-map&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>打开控制台，运行webpack：<br><img src="https://i.loli.net/2020/06/06/2YaAXdrbm9GjKgC.png" alt="运行结果"></p><p>inline-source-map打包后没有生成.map文件。</p><p>点击查看打包后的 built.js文件,在bult.js文件内部生成了以 sourceMappingURL 为索引指向源代码的文件 </p><p><img src="https://i.loli.net/2020/06/06/rNCgL1yh8J7lvMV.png" alt="inline-source-map-built"></p><h4 id="内联和外部"><a href="#内联和外部" class="headerlink" title="内联和外部"></a>内联和外部</h4><p>生成 外部.map文件的为外部；在内部生成指向源代码文件，不生成.map文件为内联</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">source-map ：外部</span><br><span class="line">inline-source-map ：内联</span><br><span class="line"></span><br><span class="line">内联和外部的区别：</span><br><span class="line"></span><br><span class="line">1.外部生成了 .map 文件，内联不生成 </span><br><span class="line">2.内联构建速度更快</span><br></pre></td></tr></table></figure><h4 id="devtool配置值"><a href="#devtool配置值" class="headerlink" title="devtool配置值"></a>devtool配置值</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">devtool: [inline-|hidden-|eval-][nosources-][cheap-[module-]] source-map</span><br><span class="line"></span><br><span class="line">souce-map: 外部</span><br><span class="line">错误代码准确信息 和 源代码的错误位置</span><br><span class="line"></span><br><span class="line">inline-source-map: 内联</span><br><span class="line">只生成一个内联source-map</span><br><span class="line">错误代码准确信息 和 源代码的错误位置</span><br><span class="line"></span><br><span class="line">hidden-source-map: 外部</span><br><span class="line">错误代码错误原因，但是没有源代码错误位置</span><br><span class="line">不能追踪源代码错误，只能提示到构建后代码的错误位置</span><br><span class="line"></span><br><span class="line">eval-sourve-map：内联</span><br><span class="line">错误代码准确信息 和 源代码的错误位置</span><br><span class="line">每一个文件都生成对应的source-map,都在eval</span><br><span class="line"></span><br><span class="line">nosources-source-map ：外部</span><br><span class="line">错误代码精确信息，但是没有任何代码信息</span><br><span class="line"></span><br><span class="line">cheap-source-map：外部</span><br><span class="line">错误代码准确信息 和 源代码的错误位置</span><br><span class="line">只能精确到行</span><br><span class="line"></span><br><span class="line">cheap-module-source-map: 外部</span><br><span class="line">错误代码精确信息 和 源代码的错误位置</span><br><span class="line">modul会将loader的source map 加入</span><br><span class="line"></span><br><span class="line">开发环境： 速度快，调试更友好</span><br><span class="line">速度快（eval&gt;inline&gt;cheap&gt;...）</span><br><span class="line">    eval-cheap-source-map</span><br><span class="line">    eval-source-map</span><br><span class="line">调试更友好</span><br><span class="line">    source-map</span><br><span class="line">    cheap-module-source-map</span><br><span class="line">    cheap-source-map</span><br><span class="line"></span><br><span class="line">--&gt; eval-source-map / eval-cheap-module-source-map</span><br><span class="line"></span><br><span class="line">生产环境：源代码要不要隐藏？ 调试要不要更友好</span><br><span class="line">内联会让代码体积变大，所以在生成环境不用内联</span><br><span class="line">nosources-source-map  全部隐藏</span><br><span class="line">hidden-source-map 只隐藏源代码，只会提示构建后代码错误信息</span><br><span class="line"></span><br><span class="line">--&gt; source-map / cheap-module-source-map</span><br></pre></td></tr></table></figure><h4 id="综上："><a href="#综上：" class="headerlink" title="综上："></a>综上：</h4><h4 id="开发环境："><a href="#开发环境：" class="headerlink" title="开发环境："></a>开发环境：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval-source-map / eval-cheap-module-source-map</span><br></pre></td></tr></table></figure><h4 id="生产环境："><a href="#生产环境：" class="headerlink" title="生产环境："></a>生产环境：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source-map / cheap-module-sourcee-map</span><br></pre></td></tr></table></figure><h4 id="PS-create-react-app中"><a href="#PS-create-react-app中" class="headerlink" title="PS: create-react-app中"></a>PS: create-react-app中</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">开发环境： cheap-module-source-map</span><br><span class="line"></span><br><span class="line">生产环境：source-map</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;source-map ： 一种提供 源代码 到 构建后代码 映射的技术，如果构建后代码出错了，通过映射可以追踪源代码错误，便于问题定位，开发调试&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>开发环境优化-HMR</title>
    <link href="https://github.com/ywAscend/2020/05/20/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E4%BC%98%E5%8C%96-HMR/"/>
    <id>https://github.com/ywAscend/2020/05/20/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E4%BC%98%E5%8C%96-HMR/</id>
    <published>2020-05-20T07:38:46.000Z</published>
    <updated>2020-06-06T14:50:22.470Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>前面配置中，无论是js还是css只要有一个文件改动，都会造成所有模块全部重新打包。项目中引入的模块较少时，影响不大。而当项目中引入上千个模块时，每次改动都会造成这些模块的重新打包，打包构建效率大大降低，影响开发效率。</p><a id="more"></a><p>那么能不能在修改后，只重新打包修改的模块呢？ HMR就是为解决这个问题而生。</p><p>HMR ： hot module replacement 热模块替换/模块热替换<br>作用：当一个模块发生变化，只会重新打包这一个模块，而不是打包所有模块，极大提升构建速度</p><h4 id="开启热模块更新功能："><a href="#开启热模块更新功能：" class="headerlink" title="开启热模块更新功能："></a>开启热模块更新功能：</h4><p>webpack.config.js中devServer开启 热更新功能</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">devServer:&#123;</span><br><span class="line">    contentBase:&apos;build&apos;,</span><br><span class="line">    compress: true,</span><br><span class="line">    port:3000,</span><br><span class="line">    open:true,</span><br><span class="line">    hot: true //开启HMR功能</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>目录结构：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">HMR</span><br><span class="line"> |- node_modules</span><br><span class="line"> |- src</span><br><span class="line"> |   |- css</span><br><span class="line"> |   |   |-iconfont.css</span><br><span class="line"> |   |   |-index.less</span><br><span class="line"> |   |- image</span><br><span class="line"> |   |   |-angular.png</span><br><span class="line"> |   |   |-vue.png</span><br><span class="line"> |   |- js</span><br><span class="line"> |   |   |-index.js</span><br><span class="line"> |   |   |-print.js</span><br><span class="line"> |   |- media</span><br><span class="line"> |   |   |-iconfont.eot</span><br><span class="line"> |   |   |-iconfont.svg</span><br><span class="line"> |   |   |-iconfont.ttf</span><br><span class="line"> |   |   |-iconfont.woff</span><br><span class="line"> |   |- index.html</span><br><span class="line"> |-webpack.config.js</span><br><span class="line"> |-package.json</span><br></pre></td></tr></table></figure><p>index.js 文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 打包入口文件</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"> //引入css</span><br><span class="line"> import &apos;../css/iconfont.css&apos;</span><br><span class="line"> //引入less</span><br><span class="line"> import &apos;../css/index.less&apos;</span><br><span class="line"></span><br><span class="line"> import print from &apos;./print&apos;</span><br><span class="line"></span><br><span class="line"> console.log(&apos;index文件加载了&apos;)</span><br><span class="line"></span><br><span class="line"> print()</span><br><span class="line"></span><br><span class="line">const add = (x,y)=&gt; x+y</span><br><span class="line"></span><br><span class="line">console.log(add(1,5))</span><br></pre></td></tr></table></figure><p>print.js 文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;printjs加载了&apos;)</span><br><span class="line"></span><br><span class="line">const print = ()=&gt;&#123;</span><br><span class="line">  const content = &apos;print打印了&apos;</span><br><span class="line">  console.log(content)</span><br><span class="line">&#125;</span><br><span class="line">export default print</span><br></pre></td></tr></table></figure><h4 id="启动项目"><a href="#启动项目" class="headerlink" title="启动项目"></a>启动项目</h4><p>浏览器控制台输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[HMR] Waiting for update signal from WDS...</span><br><span class="line">print.js:2 printjs加载了</span><br><span class="line">index.js:18 index文件加载了</span><br><span class="line">print.js:6 print打印了</span><br><span class="line">index.js:24 6</span><br><span class="line">DevTools failed to load SourceMap: Could not load content for webpack:///node_modules/_sockjs-client@1.4.0@sockjs-client/dist/sockjs.js.map: HTTP error: status code 404, net::ERR_UNKNOWN_URL_SCHEME</span><br><span class="line">client:48 [WDS] Hot Module Replacement enabled.</span><br><span class="line">client:52 [WDS] Live Reloading enabled.</span><br></pre></td></tr></table></figure><p>从浏览器控制台输出可以看出，各个模块加载ok</p><h3 id="样式文件HMR功能"><a href="#样式文件HMR功能" class="headerlink" title="样式文件HMR功能"></a>样式文件HMR功能</h3><p>样式配置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                //处理less资源</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                //处理css资源</span><br><span class="line">                test: /\.css$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>下面我们来修改 index.less文件，将图片的宽度由原来的200px,改为300px。<br>再来看看浏览器控制台输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[HMR] Waiting for update signal from WDS...</span><br><span class="line">print.js:2 printjs加载了</span><br><span class="line">index.js:18 index文件加载了</span><br><span class="line">print.js:6 print打印了</span><br><span class="line">index.js:24 6</span><br><span class="line">DevTools failed to load SourceMap: Could not load content for webpack:///node_modules/_sockjs-client@1.4.0@sockjs-client/dist/sockjs.js.map: HTTP error: status code 404, net::ERR_UNKNOWN_URL_SCHEME</span><br><span class="line">client:48 [WDS] Hot Module Replacement enabled.</span><br><span class="line">client:52 [WDS] Live Reloading enabled.</span><br><span class="line"></span><br><span class="line">2client:55 [WDS] App updated. Recompiling...</span><br><span class="line">reloadApp.js:19 [WDS] App hot update...</span><br><span class="line">log.js:24 [HMR] Checking for updates on the server...</span><br><span class="line">log.js:24 [HMR] Updated modules:</span><br><span class="line">log.js:16 [HMR]  - ./src/css/index.less //只有less模块重新编译</span><br><span class="line">log.js:24 [HMR] App is up to date.</span><br></pre></td></tr></table></figure><p>从上面操作可以看出，在没有对样式文件进行处理的情况下，样式文件可以使用HMR功能，这是因为 style-loader内部实现了HMR功能<br>因此在开发模式中通常使用 style-loader 这样不必单独对样式文件进行HMR处理。</p><h3 id="js文件HMR"><a href="#js文件HMR" class="headerlink" title="js文件HMR"></a>js文件HMR</h3><p>修改一下入口文件print.js中代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;printjs加载了&apos;)</span><br><span class="line"></span><br><span class="line">const print = ()=&gt;&#123;</span><br><span class="line">  const content = &apos;print打印了0000&apos;</span><br><span class="line">  console.log(content)</span><br><span class="line">&#125;</span><br><span class="line">export default print</span><br></pre></td></tr></table></figure><p>来看下浏览器控制台输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[HMR] Waiting for update signal from WDS...</span><br><span class="line">print.js:2 printjs加载了</span><br><span class="line">index.js:18 index文件加载了</span><br><span class="line">print.js:6 print打印了0000</span><br><span class="line">index.js:24 6</span><br></pre></td></tr></table></figure><p>发现整个包重新构建了，说明默认不能使用HMR功能。那么如果JS要使用HMR,那么需要修改js代码，添加支持 HMR功能的代码 </p><ul><li>注意： HMR功能对js的处理，只能处理非入口js文件的其他文件</li></ul><p>在 index.js文件中新增以下代码:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if(module.hot)&#123;</span><br><span class="line">  //一旦module.hot 为true,说明开启了HMR功能 --&gt; 让 HMR功能代码生效</span><br><span class="line">  module.hot.accept(&apos;./print.js&apos;,function()&#123;</span><br><span class="line">    //方法会监听 print.js文件的变化，一旦发生变化，其他默认不会重新打包构建。</span><br><span class="line">    //会执行后面的回调函数</span><br><span class="line">    print()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>保存，修改 print.js 中的代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">console.log(&apos;printjs加载了&apos;)</span><br><span class="line"></span><br><span class="line">const print = ()=&gt;&#123;</span><br><span class="line">  const content = &apos;print打印了&apos;</span><br><span class="line">  console.log(content)</span><br><span class="line">&#125;</span><br><span class="line">export default print</span><br></pre></td></tr></table></figure><p>控制台输出：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[HMR] Waiting for update signal from WDS...</span><br><span class="line">VM2890 print.js:2 printjs加载了</span><br><span class="line">index.js:18 index文件加载了</span><br><span class="line">VM2890 print.js:6 print打印了0000</span><br><span class="line">index.js:24 6</span><br><span class="line">DevTools failed to load SourceMap: Could not load content for webpack:///node_modules/_sockjs-client@1.4.0@sockjs-client/dist/sockjs.js.map: HTTP error: status code 404, net::ERR_UNKNOWN_URL_SCHEME</span><br><span class="line">client:48 [WDS] Hot Module Replacement enabled.</span><br><span class="line">client:52 [WDS] Live Reloading enabled.</span><br><span class="line"></span><br><span class="line">2client:55 [WDS] App updated. Recompiling...</span><br><span class="line">reloadApp.js:19 [WDS] App hot update...</span><br><span class="line">log.js:24 [HMR] Checking for updates on the server...</span><br><span class="line">print.js:2 printjs加载了</span><br><span class="line">print.js:6 print打印了      //print.js实现了HMR功能</span><br><span class="line">log.js:24 [HMR] Updated modules:</span><br><span class="line">log.js:24 [HMR]  - ./src/js/print.js</span><br><span class="line">log.js:24 [HMR] App is up to date.</span><br></pre></td></tr></table></figure><h3 id="html文件-HMR"><a href="#html文件-HMR" class="headerlink" title="html文件 HMR"></a>html文件 HMR</h3><p>修改 index.html文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">  &lt;title&gt;webapck&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;H1&gt;开发环境配置000&lt;/H1&gt; //修改处: 开发环境配置 --&gt; 开发环境配置000</span><br><span class="line">  &lt;div id=&quot;box2&quot;&gt;&lt;/div&gt;</span><br><span class="line">  &lt;div id=&quot;box3&quot;&gt;&lt;/div&gt;</span><br><span class="line">  &lt;img src=&quot;./image/vue.png&quot; alt=&quot;&quot;&gt;</span><br><span class="line">  &lt;span class=&quot;iconfont icon-icon-test&quot;&gt;&lt;/span&gt;</span><br><span class="line">  &lt;span class=&quot;iconfont icon-icon-test1&quot;&gt;&lt;/span&gt;</span><br><span class="line">  &lt;span class=&quot;iconfont icon-icon-test2&quot;&gt;&lt;/span&gt;</span><br><span class="line">  &lt;span class=&quot;iconfont icon-icon-test3&quot;&gt;&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>控制台并无变化。html文件：默认不能使用HMR功能，html文件不能热更新了</p><ul><li><p>解决：修改entry入口，将html文件引入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    entry: [&apos;./src/js/index.js&apos;,&apos;./src/index.html&apos;],</span><br><span class="line">    output:&#123;</span><br><span class="line">       filename:&apos;js/built.js&apos;,</span><br><span class="line">       path:Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>再次修改 index.html中的内容，发现控制台发生了变化,包重新构建一次</p></li><li><p>因热更新是多个模块下，只更新发生改变的模块，提高构建速度。而index.html只有一个文件，因此不需要HMR功能 </p><h3 id="全部配置"><a href="#全部配置" class="headerlink" title="全部配置"></a>全部配置</h3></li><li><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  entry: [&apos;./src/js/index.js&apos;,&apos;./src/index.html&apos;],</span><br><span class="line">  output:&#123;</span><br><span class="line">    filename:&apos;js/built.js&apos;,</span><br><span class="line">    path:Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module:&#123;</span><br><span class="line">    rules:[</span><br><span class="line">      //loader的配置</span><br><span class="line">      &#123;</span><br><span class="line">        //处理less资源</span><br><span class="line">        test:/\.less$/,</span><br><span class="line">        use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        //处理css资源</span><br><span class="line">        test: /\.css$/,</span><br><span class="line">        use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; //处理图片资源</span><br><span class="line">        test:/\.(png|jpg|gif)$/,</span><br><span class="line">        loader: &apos;url-loader&apos;,</span><br><span class="line">        options:&#123;</span><br><span class="line">          //小于8K的图片进行base64编码</span><br><span class="line">          limit: 8*1024,</span><br><span class="line">          //关闭es模块，启用commonjs模块</span><br><span class="line">          esModule:false, </span><br><span class="line">          //取hash值前10位的，原扩展名</span><br><span class="line">          name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">          //输出路径</span><br><span class="line">          outputPath:&apos;imgs&apos;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        //html 图片处理模块</span><br><span class="line">        test: /\.html$/,</span><br><span class="line">        use:[&apos;html-loader&apos;]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        //处理其他资源，除了 css/js/html</span><br><span class="line">        exclude: /.(css|js|html|less|png|jpg|gif)/,</span><br><span class="line">        loader: &apos;file-loader&apos;,</span><br><span class="line">        options:&#123;</span><br><span class="line">          name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">          outputPath:&apos;media&apos;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins:[</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template: &apos;./src/index.html&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">  ],</span><br><span class="line">  mode: &apos;development&apos;,</span><br><span class="line"></span><br><span class="line">  //开发服务器配置 安装webpack-dev-server ，启动指令 npx webpack-dev-server</span><br><span class="line">  devServer:&#123;</span><br><span class="line">    //项目运行目录，构建后的目录</span><br><span class="line">    contentBase: Path.resolve(__dirname,&apos;build&apos;),</span><br><span class="line">    //启动 gzip压缩，代码体积更小</span><br><span class="line">    compress: true,</span><br><span class="line">    //端口</span><br><span class="line">    port: 3000,</span><br><span class="line">    //自动打开浏览器</span><br><span class="line">    open: true,</span><br><span class="line">    //开启HMR功能</span><br><span class="line">    hot: true </span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>index.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">  /**</span><br><span class="line"> * 打包入口文件</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line"> //引入css</span><br><span class="line"> import &apos;../css/iconfont.css&apos;</span><br><span class="line"> //引入less</span><br><span class="line"> import &apos;../css/index.less&apos;</span><br><span class="line"></span><br><span class="line"> import print from &apos;./print&apos;</span><br><span class="line"></span><br><span class="line"> console.log(&apos;index文件加载了&apos;)</span><br><span class="line"></span><br><span class="line"> print()</span><br><span class="line"></span><br><span class="line">const add = (x,y)=&gt; x+y</span><br><span class="line"></span><br><span class="line">console.log(add(1,5))</span><br><span class="line"></span><br><span class="line">if(module.hot)&#123;</span><br><span class="line">  //一旦module.hot 为true,说明开启了HMR功能 --&gt; 让 HMR功能代码生效</span><br><span class="line">  module.hot.accept(&apos;./print.js&apos;,function()&#123;</span><br><span class="line">    //方法会监听 print.js文件的变化，一旦发生变化，其他默认不会重新打包构建。</span><br><span class="line">    //会执行后面的回调函数</span><br><span class="line">    print()</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;前面配置中，无论是js还是css只要有一个文件改动，都会造成所有模块全部重新打包。项目中引入的模块较少时，影响不大。而当项目中引入上千个模块时，每次改动都会造成这些模块的重新打包，打包构建效率大大降低，影响开发效率。&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>webpack性能优化</title>
    <link href="https://github.com/ywAscend/2020/05/20/webpack%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    <id>https://github.com/ywAscend/2020/05/20/webpack%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/</id>
    <published>2020-05-20T07:14:22.000Z</published>
    <updated>2020-06-06T14:49:38.107Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><ul><li>开发环境性能优化</li><li>生产环境性能优化</li></ul><a id="more"></a><h2 id="开发环境性能优化"><a href="#开发环境性能优化" class="headerlink" title="开发环境性能优化"></a>开发环境性能优化</h2><ul><li>优化打包构建速度</li><li>优化代码调试</li></ul><h2 id="生产环境性能优化"><a href="#生产环境性能优化" class="headerlink" title="生产环境性能优化"></a>生产环境性能优化</h2><ul><li>优化打包构建速度</li><li>优化代码运行的性能</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;ul&gt;
&lt;li&gt;开发环境性能优化&lt;/li&gt;
&lt;li&gt;生产环境性能优化&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>生产环境配置</title>
    <link href="https://github.com/ywAscend/2020/05/20/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
    <id>https://github.com/ywAscend/2020/05/20/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</id>
    <published>2020-05-20T06:41:01.000Z</published>
    <updated>2020-06-06T14:48:36.805Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>生产环境需要做的工作：</p><a id="more"></a><ol><li>处理css资源 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">css抽取为单独文件  --&gt; mini-css-extract-plugin</span><br><span class="line">css兼容  --&gt; postcss-loader --&gt; postcss-preset-env</span><br><span class="line">压缩css  --&gt; optimize-css-assets-webpack-plugin</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>处理js资源</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">js语法检查  --&gt; eslint  eslint-loader  eslint-config-airbnb-base eslint-plugin-import</span><br><span class="line">               // package.json 需配置 &#123; &quot;eslintConfig&quot;:&quot;airbnb-base&quot;&#125;</span><br><span class="line"></span><br><span class="line">js兼容  --&gt; babel-loader @babel/core @babel/preset-env core-js</span><br><span class="line"></span><br><span class="line">js压缩  --&gt; webpack.config.js中的 &quot;mode&quot;设置为 &apos;production&apos;即可</span><br></pre></td></tr></table></figure></li><li><p>html资源</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">打包后的js自动注册入html  --&gt; html-webpack-plugin</span><br><span class="line">压缩html --&gt; new HtmlWebpackPlugin()的minify属性</span><br></pre></td></tr></table></figure><p>完整配置：</p><h3 id="webpack-config-js"><a href="#webpack-config-js" class="headerlink" title="webpack.config.js"></a>webpack.config.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">//css抽取为单独文件</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;)</span><br><span class="line">//css压缩</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin = require(&apos;optimize-css-assets-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">//process.env.NODE_ENV = &apos;development&apos;</span><br><span class="line">process.env.NODE_ENV = &apos;prodution&apos;</span><br><span class="line"></span><br><span class="line">const commonCssConfig = [</span><br><span class="line">    MiniCssExtractPlugin.loader,</span><br><span class="line">    &apos;css-loader&apos;,</span><br><span class="line">    //css兼容</span><br><span class="line">    &#123;</span><br><span class="line">        loader:&apos;postcss-loader&apos;,</span><br><span class="line">        options:&#123;</span><br><span class="line">            indent: &apos;postcss&apos;,</span><br><span class="line">            plugins:()=&gt;[</span><br><span class="line">                require(&apos;postcss-preset-env&apos;)()   // package.json需配置 &apos;browserslist&apos;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &apos;./src/js/index.js&apos;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename:&apos;js/built.js&apos;,</span><br><span class="line">        path: Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            //js处理</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.js$/, //js语法检查 eslint --&gt;eslint-loader eslint-config-airbnb-base - eslint-plugin-import</span><br><span class="line">                exclude:/node_modules/,</span><br><span class="line">                enforce: &apos;pre&apos;,</span><br><span class="line">                loader:&apos;eslint-loader&apos;, //package.json 配置 &quot;eslintConfig&quot;: &#123;&quot;extends&quot;:&quot;airbnb-base&quot;&#125;</span><br><span class="line">                options:&#123;</span><br><span class="line">                    fix:true //自动修复</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;   //js兼容</span><br><span class="line">                test:/\.js$/, // babel: babel-loader--&gt;@babel/core--&gt;@babel/preset-env -- core-js --&gt;@babel/poly-fill</span><br><span class="line">                exclude:/node_modules/,</span><br><span class="line">                loader:&apos;babel-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    presets:[</span><br><span class="line">                        [</span><br><span class="line">                            &quot;@babel/preset-env&quot;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                useBuiltIns: &apos;usage&apos;, //按需加载</span><br><span class="line">                                corejs: 3, //指定corejs版本</span><br><span class="line">                                targets:&#123; //指定兼容到哪个版本</span><br><span class="line">                                    &quot;chrome&quot;:&quot;60&quot;,</span><br><span class="line">                                    &quot;firefox&quot;:&quot;60&quot;,</span><br><span class="line">                                    &quot;ie&quot;:&quot;9&quot;,</span><br><span class="line">                                    &quot;safari&quot;:&quot;10&quot;,</span><br><span class="line">                                    &quot;edge&quot;:&quot;11&quot;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        ]</span><br><span class="line">                    ]</span><br><span class="line">                &#125; </span><br><span class="line">            &#125;,</span><br><span class="line">            //css样式</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.css$/,</span><br><span class="line">                use: [...commonCssConfig]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use:[ ...commonCssConfig,&apos;less-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            //图片</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(jpg|png|gif)$/,</span><br><span class="line">                loader:&apos;url-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    limit:8*1024,</span><br><span class="line">                    name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">                    esModule:false,</span><br><span class="line">                    outputPath:&apos;imgs&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.html$/,</span><br><span class="line">                loader:&apos;html-loader&apos;</span><br><span class="line">            &#125;,</span><br><span class="line">            //字体图标</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(ttf|woff|woff2|svg|eot)$/,</span><br><span class="line">                loader:&apos;file-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    outputPath:&apos;media&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: process.env.NODE_ENV === &apos;development&apos; ? &apos;development&apos; : &apos;production&apos;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template:&apos;./src/index.html&apos;,</span><br><span class="line">            minify:&#123; //压缩html</span><br><span class="line">                collapseWhitespace:true, //移除空格</span><br><span class="line">                removeComments: true  //移除注释</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename: &apos;css/built.css&apos; //重命名打包后的css</span><br><span class="line">        &#125;),</span><br><span class="line">        new OptimizeCssAssetsWebpackPlugin() //压缩css</span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: &apos;build&apos;,</span><br><span class="line">        compress:true,</span><br><span class="line">        port:3000,</span><br><span class="line">        open:true,</span><br><span class="line">        hot:true  //开启热加载</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="package-json"><a href="#package-json" class="headerlink" title="package.json"></a>package.json</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;wepack_test&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;webpack.config.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;webpack&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;webpack-dev-server --open&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;@babel/core&quot;: &quot;^7.9.6&quot;,</span><br><span class="line">    &quot;@babel/polyfill&quot;: &quot;^7.8.7&quot;,</span><br><span class="line">    &quot;@babel/preset-env&quot;: &quot;^7.9.6&quot;,</span><br><span class="line">    &quot;babel-loader&quot;: &quot;^8.1.0&quot;,</span><br><span class="line">    &quot;core-js&quot;: &quot;^3.6.5&quot;,</span><br><span class="line">    &quot;css-loader&quot;: &quot;^3.5.2&quot;,</span><br><span class="line">    &quot;eslint&quot;: &quot;^7.0.0&quot;,</span><br><span class="line">    &quot;eslint-config-airbnb-base&quot;: &quot;^14.1.0&quot;,</span><br><span class="line">    &quot;eslint-loader&quot;: &quot;^4.0.2&quot;,</span><br><span class="line">    &quot;eslint-plugin-import&quot;: &quot;^2.20.2&quot;,</span><br><span class="line">    &quot;file-loader&quot;: &quot;^6.0.0&quot;,</span><br><span class="line">    &quot;html-loader&quot;: &quot;^1.1.0&quot;,</span><br><span class="line">    &quot;html-webpack-plugin&quot;: &quot;^4.2.0&quot;,</span><br><span class="line">    &quot;less&quot;: &quot;^3.11.1&quot;,</span><br><span class="line">    &quot;less-loader&quot;: &quot;^5.0.0&quot;,</span><br><span class="line">    &quot;mini-css-extract-plugin&quot;: &quot;^0.9.0&quot;,</span><br><span class="line">    &quot;optimize-css-assets-webpack-plugin&quot;: &quot;^5.0.3&quot;,</span><br><span class="line">    &quot;postcss-loader&quot;: &quot;^3.0.0&quot;,</span><br><span class="line">    &quot;postcss-preset-env&quot;: &quot;^6.7.0&quot;,</span><br><span class="line">    &quot;style-loader&quot;: &quot;^1.1.4&quot;,</span><br><span class="line">    &quot;url-loader&quot;: &quot;^4.1.0&quot;,</span><br><span class="line">    &quot;webpack&quot;: &quot;^4.42.1&quot;,</span><br><span class="line">    &quot;webpack-cli&quot;: &quot;^3.3.11&quot;,</span><br><span class="line">    &quot;webpack-dev-server&quot;: &quot;^3.10.3&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;browserslist&quot;: &#123;</span><br><span class="line">    &quot;development&quot;: [</span><br><span class="line">      &quot;last 1 chrome version&quot;,</span><br><span class="line">      &quot;last 1 firefox version&quot;,</span><br><span class="line">      &quot;last 1 safari version&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;production&quot;: [</span><br><span class="line">      &quot;&gt;0.2%&quot;,</span><br><span class="line">      &quot;not dead&quot;,</span><br><span class="line">      &quot;not op_min all&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;eslintConfig&quot;: &#123;</span><br><span class="line">    &quot;extends&quot;: &quot;airbnb-base&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;生产环境需要做的工作：&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>js兼容</title>
    <link href="https://github.com/ywAscend/2020/05/18/js%E5%85%BC%E5%AE%B9/"/>
    <id>https://github.com/ywAscend/2020/05/18/js%E5%85%BC%E5%AE%B9/</id>
    <published>2020-05-18T02:26:17.000Z</published>
    <updated>2020-06-06T14:46:52.393Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="js语法检查回顾："><a href="#js语法检查回顾：" class="headerlink" title="js语法检查回顾："></a>js语法检查回顾：</h3><p>安装的插件：</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eslint --&gt; eslint-loader --&gt; eslint-config-airbnb-base --&gt; eslint-plugin-import</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">        module:&#123;</span><br><span class="line">            rules:[</span><br><span class="line">                &#123;</span><br><span class="line">                    test:/\.js$/,</span><br><span class="line">                    exclude:/node_modules/,</span><br><span class="line">                    loader:&quot;eslint-loader&quot;,</span><br><span class="line">                    options:&#123;</span><br><span class="line">                        fix:true //自动修复</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>package.json配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;eslintConfig&quot;:&#123;</span><br><span class="line">        &quot;extends&quot;:&quot;airbnb-base&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="js语法兼容处理"><a href="#js语法兼容处理" class="headerlink" title="js语法兼容处理"></a>js语法兼容处理</h3><p>js 兼容性处理需要用到babel插件，安装以下插件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel-loader --&gt; @babel/core --&gt; @babel/preset-env</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//第一种配置：直接配置</span><br><span class="line">// 这种写法有个问题：只能转换基本语法，如promise高级语法不能转换</span><br><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                exclude:/node_modules/,</span><br><span class="line">                loader:&apos;babel-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    //预设： 指示 babel做怎样的兼容性处理</span><br><span class="line">                    presets:[</span><br><span class="line">                        &quot;@babel/preset-env&quot;</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>第二种配置： 全部js兼容性处理 –&gt; @babel/polyfill  </p><p>安装：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i @babel/polyfill -D</span><br></pre></td></tr></table></figure><p>使用：<br>入口文件index.js直接引入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos; @babel/polyfill&apos;</span><br></pre></td></tr></table></figure><p>第二种这种配置会将将所有兼容性代码全部引入，造成最后打包的体积太大，而实际上我们只需要解决部分兼容性问题。</p><p>有没有可以按需加载兼容处理的呢? 这里就要介绍三种方法了</p><p>第三种方法： 按需加载兼容，通过 core-js 来实现</p><p>安装 core-js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i core-js -D</span><br></pre></td></tr></table></figure><p>webpack.config.js中配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                exclude:/node_modules/,</span><br><span class="line">                loader:&apos;babel-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    //预设： 指示 babel做怎样的兼容性处理</span><br><span class="line">                    presets:[</span><br><span class="line">                        </span><br><span class="line">                        [</span><br><span class="line">                            &quot;@babel/preset-env&quot;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                //按需加载</span><br><span class="line">                                useBuiltIns: &apos;useage&apos;,</span><br><span class="line">                                //指定core-js版本</span><br><span class="line">                                corejs:&#123;</span><br><span class="line">                                    version: 3</span><br><span class="line">                                &#125;,</span><br><span class="line">                                targets:&#123; //指定兼容到哪个版本</span><br><span class="line">                                    chrome: &apos;60&apos;,</span><br><span class="line">                                    firefox: &apos;60&apos;,</span><br><span class="line">                                    ie:&apos;9&apos;,</span><br><span class="line">                                    safari: &apos;10&apos;,</span><br><span class="line">                                    edge:&apos;11&apos;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        ]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><h3 id="wabpck-config-js-整体配置"><a href="#wabpck-config-js-整体配置" class="headerlink" title="wabpck.config.js 整体配置"></a>wabpck.config.js 整体配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;)</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin = require(&apos;optimize-css-assets-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">process.env.NODE_ENV = &apos;development&apos;</span><br><span class="line"></span><br><span class="line">const Config = &#123;</span><br><span class="line">    entry: &apos;./src/js/index.js&apos;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: &apos;js/built.js&apos;,</span><br><span class="line">        path: Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            // &#123;</span><br><span class="line">            //     test:/\.js$/,</span><br><span class="line">            //     exclude:/node_modules/,</span><br><span class="line">            //     loader: &apos;eslint-loader&apos;,</span><br><span class="line">            //     options:&#123;</span><br><span class="line">            //         fix:true</span><br><span class="line">            //     &#125;</span><br><span class="line">            // &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                exclude:/node_modules/,</span><br><span class="line">                loader:&apos;babel-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    presets:[</span><br><span class="line">                        [</span><br><span class="line">                            &apos;@babel/preset-env&apos;,</span><br><span class="line">                            &#123;</span><br><span class="line">                                //按需加载</span><br><span class="line">                                useBuiltIns: &apos;usage&apos;,</span><br><span class="line">                                //指定core-js版本</span><br><span class="line">                                corejs:&#123;</span><br><span class="line">                                    version: 3</span><br><span class="line">                                &#125;,</span><br><span class="line">                                //指定兼容性做到哪个版本</span><br><span class="line">                                targets:&#123;</span><br><span class="line">                                    chrome: &apos;60&apos;,</span><br><span class="line">                                    firefox: &apos;60&apos;,</span><br><span class="line">                                    ie:&apos;9&apos;,</span><br><span class="line">                                    safari: &apos;10&apos;,</span><br><span class="line">                                    edge:&apos;11&apos;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        ]</span><br><span class="line"></span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: /.css$/,</span><br><span class="line">                use:[</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    &apos;css-loader&apos;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader:&apos;postcss-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            ident:&apos;postcss&apos;,</span><br><span class="line">                            plugins:()=&gt;[</span><br><span class="line">                                require(&apos;postcss-preset-env&apos;)()</span><br><span class="line">                            ]</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(png|jpg|gif)$/,</span><br><span class="line">                loader:&apos;url-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    limit: 8*1024,</span><br><span class="line">                    name:&apos;[name].[hash:10].[ext]&apos;,</span><br><span class="line">                    esModule:false,</span><br><span class="line">                    outputPath:&apos;imgs&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.html$/,</span><br><span class="line">                loader:&apos;html-loader&apos;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(ttf|woff|woff2|eot|svg)$/,</span><br><span class="line">                loader:&apos;file-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">                    outputPath:&apos;media&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: &apos;development&apos;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: &apos;./src/index.html&apos;</span><br><span class="line">        &#125;),</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename:&apos;css/built.css&apos;</span><br><span class="line">        &#125;),</span><br><span class="line">        new OptimizeCssAssetsWebpackPlugin()</span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: Path.resolve(__dirname,&apos;build&apos;),</span><br><span class="line">        compress:true,</span><br><span class="line">        port:3000,</span><br><span class="line">        open:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = Config</span><br></pre></td></tr></table></figure><h3 id="babel-单独配置，使用-babelrc"><a href="#babel-单独配置，使用-babelrc" class="headerlink" title="babel 单独配置，使用 .babelrc"></a>babel 单独配置，使用 .babelrc</h3><p>根目录下新建 .babelrc 文件,当使用babel-loader时，如果没有配置options，babel会自己去找 .babelrc然后加载其中的配置</p><p>.babelrc 简单配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;presets&quot;:[</span><br><span class="line">        &quot;@babel/preset-env&quot;,[</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;useBuiltIns&quot;:&quot;usage&quot;, //按需加载</span><br><span class="line">                &quot;corejs&quot;: 3, //core-js版本</span><br><span class="line">                &quot;targets&quot;:&#123; //指定浏览器版本</span><br><span class="line">                    &quot;chrome&quot;: &quot;60&quot;,</span><br><span class="line">                    &quot;firefox&quot;: &quot;60&quot;,</span><br><span class="line">                    &quot;ie&quot;: &quot;9&quot;,</span><br><span class="line">                    &quot;safari&quot;: &quot;10&quot;,</span><br><span class="line">                    &quot;edge&quot;:&quot;11&quot;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                loader: &apos;babel-loader&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;h3 id=&quot;js语法检查回顾：&quot;&gt;&lt;a href=&quot;#js语法检查回顾：&quot; class=&quot;headerlink&quot; title=&quot;js语法检查回顾：&quot;&gt;&lt;/a&gt;js语法检查回顾：&lt;/h3&gt;&lt;p&gt;安装的插件：&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>js语法检查</title>
    <link href="https://github.com/ywAscend/2020/05/15/js%E8%AF%AD%E6%B3%95%E6%A3%80%E6%9F%A5/"/>
    <id>https://github.com/ywAscend/2020/05/15/js%E8%AF%AD%E6%B3%95%E6%A3%80%E6%9F%A5/</id>
    <published>2020-05-15T02:09:20.000Z</published>
    <updated>2020-06-06T14:46:57.238Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>在项目中，团队代码规范，风格保持一致，对于项目维护、开发效率来说很重要。因此项目中需要进行必要的语法检查，保持代码风格统一，提高开发效率。目前使用比较广泛的就是 eslint了。</p><a id="more"></a><p>安装插件： eslint eslint-loader</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i eslint eslint-loader -D</span><br></pre></td></tr></table></figure><p>设置检查规则：在github中排名最高的为 airbnb-base，推荐使用</p><p>使用airbnb-base, 需要安装eslint-config-airbnb-base eslint eslint-plugin-import</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//安装插件(eslint上一步已安装，这里不再安装)</span><br><span class="line">cnpm i eslint-config-airbnb-base eslint-plugin-import -D</span><br></pre></td></tr></table></figure><p>webpack.config.js配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                loader:&apos;eslint-loader&apos;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>package.json中配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;eslintConfig&quot;:&#123;</span><br><span class="line">        &quot;&quot;extends&quot;:&quot;airbnb-base&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>项目入口文件index.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const add = (x,y)=&gt;x+y</span><br><span class="line">console.log(add(10,20))</span><br></pre></td></tr></table></figure><p>目前配置已完成，把项目在终端中打开，运行：webpack，发现如下报错</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ERROR in ./src/js/index.js</span><br><span class="line">Module Error (from ../node_modules/_eslint-loader@4.0.2@eslint-loader/dist/cjs.js):</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop\wproject\15.js语法检测\src\js\index.js</span><br><span class="line">  1:26  error    Expected linebreaks to be &apos;LF&apos; but found &apos;CRLF&apos;  linebreak-style</span><br><span class="line">  1:26  error    Missing semicolon                                semi</span><br><span class="line">  2:27  error    Expected linebreaks to be &apos;LF&apos; but found &apos;CRLF&apos;  linebreak-style</span><br><span class="line">  2:27  error    Missing semicolon                                semi</span><br><span class="line">  3:1   error    Expected linebreaks to be &apos;LF&apos; but found &apos;CRLF&apos;  linebreak-style</span><br><span class="line">  4:1   error    Expected linebreaks to be &apos;LF&apos; but found &apos;CRLF&apos;  linebreak-style</span><br><span class="line">  5:15  error    A space is required after &apos;,&apos;                    comma-spacing</span><br><span class="line">  5:17  error    Missing space before =&gt;                          arrow-spacing</span><br><span class="line">  5:22  error    Operator &apos;+&apos; must be spaced                      space-infix-ops</span><br><span class="line">  5:24  error    Expected linebreaks to be &apos;LF&apos; but found &apos;CRLF&apos;  linebreak-style</span><br><span class="line">  5:24  error    Missing semicolon                                semi</span><br><span class="line">  6:1   warning  Unexpected console statement                     no-console</span><br><span class="line">  6:19  error    A space is required after &apos;,&apos;                    comma-spacing</span><br><span class="line">  6:24  error    Newline required at end of file but not found    eol-last</span><br><span class="line">  6:24  error    Missing semicolon                                semi</span><br><span class="line"></span><br><span class="line">✖ 15 problems (14 errors, 1 warning)</span><br><span class="line">  14 errors and 0 warnings potentially fixable with the `--fix` option.</span><br></pre></td></tr></table></figure><p>从上述错误日志中，可看出是因为index.js中的代码，和airbnb-base中的检查规则不一致导致报错。那要一个一个手动改正吗？显然不可取。其实只需要一步即可修正一些常见的简单的规则。</p><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">        module:&#123;</span><br><span class="line">            rules:[</span><br><span class="line">                &#123;</span><br><span class="line">                    test:/\.js$/,</span><br><span class="line">                    loader:&apos;eslint-loader&apos;,</span><br><span class="line">                    //在options中配置 fix:true 即可自动修复基本语法规则</span><br><span class="line">                    options:&#123;</span><br><span class="line">                        fix:true</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>再次在终端中打开项目，运行 webpack</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop\wproject\15.js语法检测&gt;webpack</span><br><span class="line">Hash: 777adccf3aa8d036c15a</span><br><span class="line">Version: webpack 4.43.0</span><br><span class="line">Time: 2408ms</span><br><span class="line">Built at: 2020-05-15 10:05:22</span><br><span class="line">        Asset       Size  Chunks             Chunk Names</span><br><span class="line">     built.js   17.9 KiB    main  [emitted]  main</span><br><span class="line">css/built.css   18 bytes    main  [emitted]  main</span><br><span class="line">   index.html  386 bytes          [emitted]</span><br><span class="line">Entrypoint main = css/built.css built.js</span><br><span class="line">[../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js!./src/css/index.less] 288 bytes &#123;main&#125;</span><br><span class="line">[built]</span><br><span class="line">[./src/css/index.css] 39 bytes &#123;main&#125; [built]</span><br><span class="line">[./src/css/index.less] 635 bytes &#123;main&#125; [built]</span><br><span class="line">[./src/js/index.js] 107 bytes &#123;main&#125; [built] [1 warning]</span><br><span class="line">    + 3 hidden modules</span><br><span class="line"></span><br><span class="line">WARNING in ./src/js/index.js</span><br><span class="line">Module Warning (from ../node_modules/_eslint-loader@4.0.2@eslint-loader/dist/cjs.js):</span><br><span class="line"></span><br><span class="line">C:\Users\Administrator\Desktop\wproject\15.js语法检测\src\js\index.js</span><br><span class="line">  6:1  warning  Unexpected console statement  no-console</span><br><span class="line"></span><br><span class="line">✖ 1 problem (0 errors, 1 warning)</span><br><span class="line"></span><br><span class="line">Child HtmlWebpackCompiler:</span><br><span class="line">     1 asset</span><br><span class="line">    Entrypoint HtmlWebpackPlugin_0 = __child-HtmlWebpackPlugin_0</span><br><span class="line">    [../node_modules/_html-webpack-plugin@4.3.0@html-webpack-plugin/lib/loader.js!./src/index.html] 406 bytes &#123;HtmlWebpackPlugin_0&#125; [built]</span><br><span class="line">Child mini-css-extract-plugin ../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??postcss!src/css/index.css:</span><br><span class="line">    Entrypoint mini-css-extract-plugin = *</span><br><span class="line">    [../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js?!./src/css/index.css] ../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src??postcss!./src/css/index.css 288 bytes &#123;mini-css-extract-plugin&#125; [built]</span><br><span class="line">        + 1 hidden module</span><br></pre></td></tr></table></figure><p>项目打包成功，但是有一个waring(稍后再看),再来看项目入口文件 index.js中的代码。<br>修复前：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const add = (x,y)=&gt;x+y</span><br><span class="line">console.log(add(10,20))</span><br></pre></td></tr></table></figure><p>修复后：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const add = (x, y) =&gt; x + y; //eslint自动修复了代码</span><br><span class="line">console.log(add(10, 20));</span><br></pre></td></tr></table></figure><p>eslint自动修复Ok,现在我们来看看刚才出现的waring</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop\wproject\15.js语法检测\src\js\index.js</span><br><span class="line">  6:1  warning  Unexpected console statement  no-console</span><br><span class="line"></span><br><span class="line">✖ 1 problem (0 errors, 1 warning)</span><br></pre></td></tr></table></figure><p>no-console 说明是index.js中的 console.log(add(10,20)) ,airbnb不建议在项目中使用console,解决如下<br>index.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const add = (x, y) =&gt; x + y; //eslint自动修复了代码</span><br><span class="line">//eslint-diable-next-line</span><br><span class="line">console.log(add(10, 20));  //这一行代码不进行eslint检测</span><br></pre></td></tr></table></figure><p>再次在终端中运行：webapck</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop\wproject\15.js语法检测&gt;webpack</span><br><span class="line">Hash: 2caa20ab5beed81950bc</span><br><span class="line">Version: webpack 4.43.0</span><br><span class="line">Time: 2387ms</span><br><span class="line">Built at: 2020-05-15 10:06:04</span><br><span class="line">        Asset       Size  Chunks             Chunk Names</span><br><span class="line">     built.js   17.9 KiB    main  [emitted]  main</span><br><span class="line">css/built.css   18 bytes    main  [emitted]  main</span><br><span class="line">   index.html  386 bytes          [emitted]</span><br><span class="line">Entrypoint main = css/built.css built.js</span><br><span class="line">[../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_less-loader@5.0.0@less-loader/dist/cjs.js!./src/css/index.less] 288 bytes &#123;main&#125;</span><br><span class="line">[built]</span><br><span class="line">[./src/css/index.css] 39 bytes &#123;main&#125; [built]</span><br><span class="line">[./src/css/index.less] 635 bytes &#123;main&#125; [built]</span><br><span class="line">[./src/js/index.js] 140 bytes &#123;main&#125; [built]</span><br><span class="line">    + 3 hidden modules</span><br><span class="line">Child HtmlWebpackCompiler:</span><br><span class="line">     1 asset</span><br><span class="line">    Entrypoint HtmlWebpackPlugin_0 = __child-HtmlWebpackPlugin_0</span><br><span class="line">    [../node_modules/_html-webpack-plugin@4.3.0@html-webpack-plugin/lib/loader.js!./src/index.html] 406 bytes &#123;HtmlWebpackPlugin_0&#125; [built]</span><br><span class="line">Child mini-css-extract-plugin ../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??postcss!src/css/index.css:</span><br><span class="line">    Entrypoint mini-css-extract-plugin = *</span><br><span class="line">    [../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js?!./src/css/index.css] ../node_modules/_css-loader@3.5.3@css-loader/dist/cjs.js!../node_modules/_postcss-loader@3.0.0@postcss-loader/src??postcss!./src/css/index.css 288 bytes &#123;mini-css-extract-plugin&#125; [built]</span><br><span class="line">        + 1 hidden module</span><br></pre></td></tr></table></figure><p>waring已经没有了，但是在实际项目中最好不要使用 //eslint-diable-next-line</p><h3 id="完整配置"><a href="#完整配置" class="headerlink" title="完整配置"></a>完整配置</h3><p>package.json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;wepack_test&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;webpack.config.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;,</span><br><span class="line">    &quot;build&quot;: &quot;webpack&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;webpack-dev-server --open&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;css-loader&quot;: &quot;^3.5.2&quot;,</span><br><span class="line">    &quot;eslint&quot;: &quot;^7.0.0&quot;,</span><br><span class="line">    &quot;eslint-config-airbnb-base&quot;: &quot;^14.1.0&quot;,</span><br><span class="line">    &quot;eslint-loader&quot;: &quot;^4.0.2&quot;,</span><br><span class="line">    &quot;eslint-plugin-import&quot;: &quot;^2.20.2&quot;,</span><br><span class="line">    &quot;file-loader&quot;: &quot;^6.0.0&quot;,</span><br><span class="line">    &quot;html-loader&quot;: &quot;^1.1.0&quot;,</span><br><span class="line">    &quot;html-webpack-plugin&quot;: &quot;^4.2.0&quot;,</span><br><span class="line">    &quot;less&quot;: &quot;^3.11.1&quot;,</span><br><span class="line">    &quot;less-loader&quot;: &quot;^5.0.0&quot;,</span><br><span class="line">    &quot;mini-css-extract-plugin&quot;: &quot;^0.9.0&quot;,</span><br><span class="line">    &quot;optimize-css-assets-webpack-plugin&quot;: &quot;^5.0.3&quot;,</span><br><span class="line">    &quot;postcss-loader&quot;: &quot;^3.0.0&quot;,</span><br><span class="line">    &quot;postcss-preset-env&quot;: &quot;^6.7.0&quot;,</span><br><span class="line">    &quot;style-loader&quot;: &quot;^1.1.4&quot;,</span><br><span class="line">    &quot;url-loader&quot;: &quot;^4.1.0&quot;,</span><br><span class="line">    &quot;webpack&quot;: &quot;^4.42.1&quot;,</span><br><span class="line">    &quot;webpack-cli&quot;: &quot;^3.3.11&quot;,</span><br><span class="line">    &quot;webpack-dev-server&quot;: &quot;^3.10.3&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;browserslist&quot;: &#123;</span><br><span class="line">    &quot;development&quot;: [</span><br><span class="line">      &quot;last 1 chrome version&quot;,</span><br><span class="line">      &quot;last 1 firefox version&quot;,</span><br><span class="line">      &quot;last 1 safari version&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;production&quot;: [</span><br><span class="line">      &quot;&gt;0.2%&quot;,</span><br><span class="line">      &quot;not dead&quot;,</span><br><span class="line">      &quot;not op_min all&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;eslintConfig&quot;:&#123;</span><br><span class="line">    &quot;extends&quot;:&quot;airbnb-base&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;)</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin = require(&apos;optimize-css-assets-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">//css兼容需设置nodejs 中的环境变量</span><br><span class="line">process.env.NODE_ENV = &apos;prodction&apos;</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &apos;./src/js/index.js&apos;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: &apos;built.js&apos;,</span><br><span class="line">        path: Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;   </span><br><span class="line">                /**</span><br><span class="line">                 * 只检查自己写的源代码，第三方的库不用检查</span><br><span class="line">                 * </span><br><span class="line">                 * eslint eslint-loader </span><br><span class="line">                 * </span><br><span class="line">                 * 插件airbnb： eslint-config-airbnb-base eslint-plugin-import</span><br><span class="line">                 * </span><br><span class="line">                 * package.json中配置</span><br><span class="line">                 * </span><br><span class="line">                 * &quot;eslintConfig&quot;:&#123;</span><br><span class="line">                 *      &quot;extends&quot;:&quot;airbnb-base&quot;</span><br><span class="line">                 *  &#125;</span><br><span class="line">                 * </span><br><span class="line">                 */</span><br><span class="line">                test:/\.js$/,</span><br><span class="line">                exclude:/node_modules/,</span><br><span class="line">                loader:&apos;eslint-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    fix: true</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;   </span><br><span class="line">                test:/\.css$/,</span><br><span class="line">                use:[</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    &apos;css-loader&apos;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader:&apos;postcss-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            ident:&apos;postcss&apos;,</span><br><span class="line">                            plugins:()=&gt;[</span><br><span class="line">                                require(&apos;postcss-preset-env&apos;)()</span><br><span class="line">                            ]</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use:[</span><br><span class="line">                    &apos;style-loader&apos;,</span><br><span class="line">                    &apos;css-loader&apos;,</span><br><span class="line">                    &apos;less-loader&apos;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(jpg|png|gif)$/,</span><br><span class="line">                loader:&apos;url-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    limit: 8*1024,</span><br><span class="line">                    name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">                    esModule:false,</span><br><span class="line">                    outputPath:&apos;imgs&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.html$/,</span><br><span class="line">                loader:&apos;html-loader&apos;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(woff|woff2|ttf|eot|svg)$/,</span><br><span class="line">                loader:&apos;file-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">                    outputPath:&apos;media&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: &apos;development&apos;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template:&apos;./src/index.html&apos;</span><br><span class="line">        &#125;),</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            filename:&apos;css/built.css&apos;</span><br><span class="line">        &#125;),</span><br><span class="line">        new OptimizeCssAssetsWebpackPlugin()</span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase:Path.resolve(__dirname,&apos;build&apos;),</span><br><span class="line">        compress:true,</span><br><span class="line">        port:3000,</span><br><span class="line">        open:true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;在项目中，团队代码规范，风格保持一致，对于项目维护、开发效率来说很重要。因此项目中需要进行必要的语法检查，保持代码风格统一，提高开发效率。目前使用比较广泛的就是 eslint了。&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>git提交或add时提示LF将会被替换为CRLF</title>
    <link href="https://github.com/ywAscend/2020/05/14/git%E6%8F%90%E4%BA%A4%E6%88%96add%E6%97%B6%E6%8F%90%E7%A4%BALF%E5%B0%86%E4%BC%9A%E8%A2%AB%E6%9B%BF%E6%8D%A2%E4%B8%BACRLF/"/>
    <id>https://github.com/ywAscend/2020/05/14/git%E6%8F%90%E4%BA%A4%E6%88%96add%E6%97%B6%E6%8F%90%E7%A4%BALF%E5%B0%86%E4%BC%9A%E8%A2%AB%E6%9B%BF%E6%8D%A2%E4%B8%BACRLF/</id>
    <published>2020-05-14T09:14:31.000Z</published>
    <updated>2020-06-06T14:45:29.306Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>什么是LF和CRLF ?<br>1.LF和CRLF都是换行符，在各操作系统下，换行符是不一样的，Linux/UNIX下是LF,而Windows下是CRLF，早期的MAC OS是CR,后来的OS X在更换内核后和UNIX一样也是LF.<br>这种不统一确实对跨平台的文件交换带来了麻烦。虽然靠谱的文本编辑器和 IDE 都支持这几种换行符，但文件在保存时总要有一个固定的标准啊，比如跨平台协作的项目源码，到底保存为哪种风格的换行符呢？</p><a id="more"></a><p>2.Git 由大名鼎鼎的 Linus 开发，最初只可运行于 *nix 系统，因此推荐只将 UNIX 风格的换行符保存入库。但它也考虑到了跨平台协作的场景，并且提供了一个“换行符自动转换”功能。</p><p>安装好 GitHub 的 Windows 客户端之后，这个功能默认处于“自动模式”。<br>当你在签出文件时，Git 试图将 UNIX 换行符（LF）替换为 Windows 的换行符（CRLF）；当你在提交文件时，它又试图将 CRLF 替换为 LF。<br>所以Git在拉取代码的时候，git会自动将代码之中与你当前系统不同的换行方式自动转换成当前系统的换行方式。<br>这样一来在提交代码的时候，git会认为你未修改内容的文件也认为是修改过的，然后提示你warning: LF will be replaced by CRLF这样的信息。<br>3.上面的解决办法固然解决了很多人的问题，但是在某些情况下就不适用。这次项目中，在用fiskit框架npm deploy打包前端文件到后端路径的时候，打包出来的文件用git进行commit的时候，提示LF和CRLF，文件的换行符被修改过，这时候也尝试了上面的方法，也没有用，最后在知乎上看到一篇文章<a href="https://www.zhihu.com/question/50862500，" target="_blank" rel="noopener">https://www.zhihu.com/question/50862500，</a></p><p>有效的解决方法<br>如果设置core.autocrlf = false，那么很可能会出现CRLF和LF混合的情况，这样会导致一些问题，例如git diff 失去功能，会发现很多行代码并没有修改，然而被认为是修改过了。<br>首先core.autocrlf = true在windows上才是正确的选择，那么如何避免warning呢？还要有以下几个步骤：</p><p>添加.gitattributes<br>设置core.safecrlf = true<br>使用dos2unix、notepad++等工具来将LF转换成CRLF</p><p>使用 dos2unix 将CRLF转换为LF:</p><p>dos2unix命令用来将DOS格式的文本文件转换成UNIX格式的（DOS/MAC to UNIX text file format converter）<br>将UNIX格式文本文件转成成DOS格式的是unix2dos命令。</p><p>如果一次转换多个文件，把这些文件名直接跟在dos2unix之后。（注：也可以加上-o参数，也可以不加，效果一样）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">dos2unix file1 file2 file3 </span><br><span class="line">dos2unix -o file1 file2 file3</span><br></pre></td></tr></table></figure><p>如果批量替换public/components 目录下的所有文件使用如下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find public/components/ -name &quot;*&quot; | xargs dos2unix</span><br></pre></td></tr></table></figure><p>要更改文件格式的后缀为.js ,那么借助于下面的命令就可以轻松的实现批量替换格式：<br>批量替换为linux文件格式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find public/components/ -name &quot;*.js&quot; | xargs dos2unix</span><br></pre></td></tr></table></figure><p>批量替换为dos文件格式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find public/components/ -name &quot;*.js&quot; | xargs unix2dos</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;什么是LF和CRLF ?&lt;br&gt;1.LF和CRLF都是换行符，在各操作系统下，换行符是不一样的，Linux/UNIX下是LF,而Windows下是CRLF，早期的MAC OS是CR,后来的OS X在更换内核后和UNIX一样也是LF.&lt;br&gt;这种不统一确实对跨平台的文件交换带来了麻烦。虽然靠谱的文本编辑器和 IDE 都支持这几种换行符，但文件在保存时总要有一个固定的标准啊，比如跨平台协作的项目源码，到底保存为哪种风格的换行符呢？&lt;/p&gt;
    
    </summary>
    
    
      <category term="版本控制工具" scheme="https://github.com/ywAscend/categories/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="git" scheme="https://github.com/ywAscend/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>css兼容处理和压缩</title>
    <link href="https://github.com/ywAscend/2020/05/14/css%E5%85%BC%E5%AE%B9%E5%92%8C%E5%8E%8B%E7%BC%A9%E5%A4%84%E7%90%86/"/>
    <id>https://github.com/ywAscend/2020/05/14/css%E5%85%BC%E5%AE%B9%E5%92%8C%E5%8E%8B%E7%BC%A9%E5%A4%84%E7%90%86/</id>
    <published>2020-05-14T05:23:24.000Z</published>
    <updated>2020-06-06T14:42:48.436Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="css兼容"><a href="#css兼容" class="headerlink" title="css兼容"></a>css兼容</h3><p>前面css-loader将css处理为js资源是的webpack能够引入样式资源，style-loader将处理后的样式资源插入到head中。但是页面加时，css先转为js再引入到页面时，会造成页面闪白。所以通过 mini-css-extract-plugin 将css资源通过link形式引入，解决页面闪白的问题。<br>实际开发中还要考虑css对各浏览器的兼容性处理，为了解放开发人员，让开发人员专注于开发工作，这种兼容性工作通常使用插件处理。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">postcss: 处理兼容性的插件</span><br><span class="line"></span><br><span class="line">使用postcss需要下载:   postcss-loader --&gt; postcss-preset-env</span><br><span class="line"></span><br><span class="line">postcss-preset-env 插件的作用：</span><br><span class="line">帮助 postcss 找到 package.json 中的 browerslist 里面的配置，通过配置加载指定的css兼容性样式</span><br></pre></td></tr></table></figure><p>使用postcss：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//安装postcss-loader、postcss-preset-env</span><br><span class="line">cnpm i postcss-loader postcss-preset-env -D</span><br></pre></td></tr></table></figure><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-pluign&apos;)</span><br><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.css$/,</span><br><span class="line">                use:[</span><br><span class="line">                   MiniCssExtractPlugin.loader,</span><br><span class="line">                   &apos;css-loader&apos;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: &apos;postcss-loader&apos;,</span><br><span class="line">                        options:&#123;</span><br><span class="line">                            indent: &apos;postcss&apos;, //固定写法</span><br><span class="line">                            pulgins:()=&gt;[</span><br><span class="line">                                //插件帮助 postcss找到package.json中 &apos;browserslist&apos;中的配置，加载指定的css样式</span><br><span class="line">                                require(&apos;postcss-preset-env&apos;)()</span><br><span class="line">                            ]</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>package.json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;browserslist&quot;:&#123;   //postcss 配置</span><br><span class="line">    &quot;development&quot;:[</span><br><span class="line">      &quot;last 1 chrome version&quot;,</span><br><span class="line">      &quot;last 1 firefox version&quot;,</span><br><span class="line">      &quot;last 1 safari version&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;production&quot;:[</span><br><span class="line">      &quot;&gt;0.2%&quot;,</span><br><span class="line">      &quot;not dead&quot;,</span><br><span class="line">      &quot;not op_min all&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="css压缩"><a href="#css压缩" class="headerlink" title="css压缩"></a>css压缩</h3><p>实际打包中，为减少打的包体积，代码压缩是常用的手段。css压缩也不例外。<br>通常使用 optimize-css-assets-webpack-plugin 来进行css压缩</p><p>安装optimize-css-assets-webpack-plugin插件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i optimize-css-assets-webpack-plugin -D</span><br></pre></td></tr></table></figure><p>使用插件<br>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//引入optimize-css-assets-webpack-plugin</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin = require(&apos;optimize-css-assets-webpack-plugin&apos;)</span><br><span class="line">const config = &#123;</span><br><span class="line">  plugins:[</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin() //基础使用</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="完整配置"><a href="#完整配置" class="headerlink" title="完整配置"></a>完整配置</h3><p>webpack.config.js</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">//引入路径</span><br><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">//引入 html-webpack-plugin 打包后的js自动注册入html中</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">//引入mini-css-extract-plugin，css link引入</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;)</span><br><span class="line"></span><br><span class="line">//引入 optimize-css-assets-webpack-plugin, 压缩css</span><br><span class="line">const OptimizeCssAssetsWebpackPlugin = require(&apos;optimize-css-assets-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  entry: &apos;./src/index.js&apos;,</span><br><span class="line">  output:&#123;</span><br><span class="line">    filename: &apos;built.js&apos;,</span><br><span class="line">    path: Path.reslove(__dirname,&apos;build&apos;)</span><br><span class="line">  &#125;,</span><br><span class="line">  module:&#123;</span><br><span class="line">    rules:[</span><br><span class="line">      //样式资源</span><br><span class="line">      &#123;</span><br><span class="line">        test:/\.css$/,</span><br><span class="line">        use:[</span><br><span class="line">          MiniCssExtractPlugin.loader,</span><br><span class="line">          &apos;css-loader&apos;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &apos;postcss-loader&apos;,</span><br><span class="line">            options:&#123;</span><br><span class="line">              ident: &apos;postcss&apos;,</span><br><span class="line">              plugins:()=&gt;[</span><br><span class="line">                require(&apos;postcss-preset-env&apos;)()  //帮助postcss找到package.json中的&apos;browserslist&apos;配置，加载指定的兼容样式</span><br><span class="line">              ]</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test:/.less$/,</span><br><span class="line">            use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">          &#125;,</span><br><span class="line">          //图片资源</span><br><span class="line">          &#123;</span><br><span class="line">            test:/\.(jpg|png|gif)$/,</span><br><span class="line">            loader:&apos;url-loader&apos;,</span><br><span class="line">            options:&#123;</span><br><span class="line">              limit: 8*1024,</span><br><span class="line">              esModule:false,</span><br><span class="line">              name:&apos;[name].[hashL:10].[ext]&apos;,</span><br><span class="line">              outputPath:&apos;imgs&apos;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test:/\.html$/,</span><br><span class="line">            loader:&apos;html-loader&apos;</span><br><span class="line">          &#125;,</span><br><span class="line">          //字体图标资源</span><br><span class="line">          &#123;</span><br><span class="line">            test:/\.(woff2|eot|ttf|woff|svg)$/,</span><br><span class="line">            loader: &apos;file-loader&apos;,</span><br><span class="line">            options:&#123;</span><br><span class="line">              name:&apos;[hash:10].[ext]&apos;,</span><br><span class="line">              outputPath:&apos;media&apos;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  mode: &apos;development&apos;,</span><br><span class="line">  plugins:[</span><br><span class="line">    new HtmlWebpackPlugin(&#123;</span><br><span class="line">      template:&apos;./src/index.html&apos;</span><br><span class="line">    &#125;),</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      //对输出的文件进行重命名</span><br><span class="line">      filename: &apos;css/built.css&apos;</span><br><span class="line">    &#125;),</span><br><span class="line">    new OptimizeCssAssetsWebpackPlugin() //压缩css</span><br><span class="line">  ],</span><br><span class="line">  devServer:&#123;  //webapck-dev-server</span><br><span class="line">    contentBase: Path.reslove(__dirname,&apos;build&apos;),</span><br><span class="line">    port:3000,</span><br><span class="line">    compress:true,</span><br><span class="line">    open:true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>package.json</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;wepack_test&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;webpack.config.js&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;css-loader&quot;: &quot;^3.5.2&quot;,</span><br><span class="line">    &quot;file-loader&quot;: &quot;^6.0.0&quot;,</span><br><span class="line">    &quot;html-loader&quot;: &quot;^1.1.0&quot;,</span><br><span class="line">    &quot;html-webpack-plugin&quot;: &quot;^4.2.0&quot;,</span><br><span class="line">    &quot;less&quot;: &quot;^3.11.1&quot;,</span><br><span class="line">    &quot;less-loader&quot;: &quot;^5.0.0&quot;,</span><br><span class="line">    &quot;mini-css-extract-plugin&quot;: &quot;^0.9.0&quot;,</span><br><span class="line">    &quot;optimize-css-assets-webpack-plugin&quot;: &quot;^5.0.3&quot;,</span><br><span class="line">    &quot;postcss-loader&quot;: &quot;^3.0.0&quot;,</span><br><span class="line">    &quot;postcss-preset-env&quot;: &quot;^6.7.0&quot;,</span><br><span class="line">    &quot;style-loader&quot;: &quot;^1.1.4&quot;,</span><br><span class="line">    &quot;url-loader&quot;: &quot;^4.1.0&quot;,</span><br><span class="line">    &quot;webpack&quot;: &quot;^4.42.1&quot;,</span><br><span class="line">    &quot;webpack-cli&quot;: &quot;^3.3.11&quot;,</span><br><span class="line">    &quot;webpack-dev-server&quot;: &quot;^3.10.3&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;browserslist&quot;:&#123;</span><br><span class="line">    &quot;development&quot;:[</span><br><span class="line">      &quot;last 1 chrome version&quot;,</span><br><span class="line">      &quot;last 1 firefox version&quot;,</span><br><span class="line">      &quot;last 1 safari version&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;production&quot;:[</span><br><span class="line">      &quot;&gt;0.2%&quot;,</span><br><span class="line">      &quot;not dead&quot;,</span><br><span class="line">      &quot;not op_min all&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;h3 id=&quot;css兼容&quot;&gt;&lt;a href=&quot;#css兼容&quot; class=&quot;headerlink&quot; title=&quot;css兼容&quot;&gt;&lt;/a&gt;css兼容&lt;/h3&gt;&lt;p&gt;前面css-loader将css处理为js资源是的webpack能够引入样式资源，style-loader将处理后的样式资源插入到head中。但是页面加时，css先转为js再引入到页面时，会造成页面闪白。所以通过 mini-css-extract-plugin 将css资源通过link形式引入，解决页面闪白的问题。&lt;br&gt;实际开发中还要考虑css对各浏览器的兼容性处理，为了解放开发人员，让开发人员专注于开发工作，这种兼容性工作通常使用插件处理。&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>webpack-css抽离为单独文件</title>
    <link href="https://github.com/ywAscend/2020/05/13/css%E6%8A%BD%E7%A6%BB%E4%B8%BA%E5%8D%95%E7%8B%AC%E6%96%87%E4%BB%B6/"/>
    <id>https://github.com/ywAscend/2020/05/13/css%E6%8A%BD%E7%A6%BB%E4%B8%BA%E5%8D%95%E7%8B%AC%E6%96%87%E4%BB%B6/</id>
    <published>2020-05-13T13:20:45.000Z</published>
    <updated>2020-05-13T13:38:37.516Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>基础配置中的css是通过style-loader 转为js的样式文件，最后插入在head中引入样式。这样的好处是，页面加载时不会重新请求css文件，但也有缺点页面一次性加载内容较多，影响加载速度。</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            test:/\.css$/,</span><br><span class="line">            use:[</span><br><span class="line">                &apos;style-loader&apos;, //创建style标签，将样式放入head中</span><br><span class="line">                &apos;css-loader&apos;</span><br><span class="line">            ]</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><p>运行效果：<br><img src="https://i.loli.net/2020/05/13/Wj9ZpilE8mVx2sF.png" alt="css-style.png"></p><p>通过 mini-css-extract-plugin 插件，将打包后的css通过link引入<br>好处：页面不会闪白 弊端：会发生link请求</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//安装插件 </span><br><span class="line">cnpm i mini-css-extract-plugin</span><br><span class="line">//引入插件</span><br><span class="line">const MiniCssExtractPlugin = require(&apos;mini-css-extract-plugin&apos;)</span><br><span class="line">// 配置</span><br><span class="line">const config = &#123;</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            // &apos;style-loader&apos; ,</span><br><span class="line">            MiniCssExtractPluign.loader, //这个loader取代style-loader。作用：提取js中的css成单独文件</span><br><span class="line">            &apos;css-loader&apos;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            //对输出文件进行重命名</span><br><span class="line">            filename: &apos;css/built.css&apos;</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行效果：</p><!-- ![css-link.png](https://i.loli.net/2020/05/13/hUBflnIqzFcP4Yb.png) --><p><img src="/images/css-link.png" alt></p><p>完整配置 webpack.config.js：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">//引入路径</span><br><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line">//引入 html-webpack-pluign插件，作用将webpack打包后的js自动注入到html中</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line">//引入mini-css-extract-plugin 插件，作用抽取css为单独文件</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry:&apos;./src/js/index.js&apos;,</span><br><span class="line">    output:&#123;</span><br><span class="line">        filename: &apos;buit.js&apos;,</span><br><span class="line">        path: Path.reslove(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            //样式loader</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.css$/,</span><br><span class="line">                use:[</span><br><span class="line">                    MiniCssExtractPlugin.loader,</span><br><span class="line">                    &apos;css-loader&apos;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.less$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            //图片loader</span><br><span class="line">            &#123;</span><br><span class="line">                test:/\.(jpg|png|gif)$/,</span><br><span class="line">                loader: &apos;url-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    limit: 8*1024, </span><br><span class="line">                    esModule:false,</span><br><span class="line">                    name: &apos;[name].[hash:10].[ext]&apos;,</span><br><span class="line">                    outPath:&apos;img&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.html$/,</span><br><span class="line">                loader: &apos;html-loader&apos;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                //处理字体图标</span><br><span class="line">                test:/\.(woff2|eot|ttf|woff|svg)$/,</span><br><span class="line">                loader: &apos;file-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    outputPath:&apos;media&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: &apos;development&apos;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: &apos;./src/index.html&apos;</span><br><span class="line">        &#125;),</span><br><span class="line">        new MiniCssExtractPlugin(&#123;</span><br><span class="line">            //对输出文件进行重命名</span><br><span class="line">            filename: &apos;css/built.css&apos;</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: Path.reslove(__dirname,&apos;build&apos;),</span><br><span class="line">        compress: true,</span><br><span class="line">        port: 3000,</span><br><span class="line">        open: true</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;基础配置中的css是通过style-loader 转为js的样式文件，最后插入在head中引入样式。这样的好处是，页面加载时不会重新请求css文件，但也有缺点页面一次性加载内容较多，影响加载速度。&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>webpack基本配置</title>
    <link href="https://github.com/ywAscend/2020/05/13/webpack%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/"/>
    <id>https://github.com/ywAscend/2020/05/13/webpack%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/</id>
    <published>2020-05-13T13:15:18.000Z</published>
    <updated>2020-05-13T13:16:37.847Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>webpack基本配置</p><a id="more"></a><ol><li>入口</li></ol><p>一、单个入口文件：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        main: &apos;./src/index.js&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>单个入口文件简写：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &apos;./src/index.js&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>二、对象语法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: &apos;./src/index.js&apos;,</span><br><span class="line">        vendors: &apos;./src/vendors.js&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>常见应用场景：</p><p>分离应用程序和第三方库入口：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">entry: &#123;</span><br><span class="line">    app: &apos;./src/app.js&apos;,</span><br><span class="line">    vendors: &apos;./src/vendors.js&apos;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>webpack 从 app.js 和 vendors.js 开始创建依赖图(dependency graph)。这些依赖图是彼此完全分离、互相独立的（每个 bundle 中都有一个 webpack 引导(bootstrap)）。这种方式比较常见于，只有一个入口起点（不包括 vendor）的单页应用程序(single page application)中。</p><p>此设置允许你使用 CommonsChunkPlugin 从「应用程序 bundle」中提取 vendor 引用(vendor reference) 到 vendor bundle，并把引用 vendor 的部分替换为 <strong>webpack_require</strong>() 调用。如果应用程序 bundle 中没有 vendor 代码，那么你可以在 webpack 中实现被称为长效缓存的通用模式。</p><p>多页面应用程序：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">entry: &#123;</span><br><span class="line">    pageOne: &apos;./src/pageOne/index.js&apos;,</span><br><span class="line">    pageTwo: &apos;./src/pageTwo/index.js&apos;,</span><br><span class="line">    pageThree: &apos;./src/pageThree/index.js&apos;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的示例告诉 webpack 需要 3 个独立分离的依赖图.<br>在多页应用中，（译注：每当页面跳转时）服务器将为你获取一个新的 HTML 文档。页面重新加载新文档，并且资源被重新下载。然而，这给了我们特殊的机会去做很多事：<br>使用 CommonsChunkPlugin 为每个页面间的应用程序共享代码创建 bundle。由于入口起点增多，多页应用能够复用入口起点之间的大量代码/模块，从而可以极大地从这些技术中受益。</p><ol start="2"><li>出口  </li></ol><p>配置 output 选项可以控制 webpack 如何向硬盘写入编译文件。注意，即使可以存在多个入口起点，但只指定一个输出配置.</p><p>output 的值需要设置为一个对象，包含以下两点：</p><p>filename 用于输出文件的文件名。</p><p>目标输出目录 path 的绝对路径。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: &apos;built.js&apos;,</span><br><span class="line">        path: path.reslove(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>多个入口起点</p><p>如果配置创建了多个单独的 “chunk”（例如，使用多个入口起点或使用像 CommonsChunkPlugin 这样的插件），则应该使用占位符(substitutions)来确保每个文件具有唯一的名称。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    entry: &#123;</span><br><span class="line">        app: &apos;./src/app.js&apos;,</span><br><span class="line">        search: &apos;./src/search.js&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: &apos;[name].js&apos;,</span><br><span class="line">        path: __dirname + &apos;/dist&apos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 写入到硬盘：./dist/app.js, ./dist/search.js</span><br></pre></td></tr></table></figure><p>使用CDN加速(官方示例，没太懂)</p><p>config.js </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    path: &quot;/home/proj/cdn/assets/[hash]&quot;,</span><br><span class="line">    publicPath: &quot;http://cdn.example.com/assets/[hash]/&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在编译时不知道最终输出文件的 publicPath 的情况下，publicPath 可以留空，并且在入口起点文件运行时动态设置。如果你在编译时不知道 publicPath，你可以先忽略它，并且在入口起点设置 <strong>webpack_public_path</strong>。</p><ol start="3"><li>loader</li></ol><h4 id="处理样式-css-less-sass"><a href="#处理样式-css-less-sass" class="headerlink" title="处理样式 css/less/sass"></a>处理样式 css/less/sass</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.css$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.les$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.(sass|scss)$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;sass-loader&apos;]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><h4 id="处理图片-jpg-png-gif-jpeg"><a href="#处理图片-jpg-png-gif-jpeg" class="headerlink" title="处理图片 jpg|png|gif|jpeg"></a>处理图片 jpg|png|gif|jpeg</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">const config = &#123;</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.(jpg|png|gif|jpeg)$/,</span><br><span class="line">                loader: &apos;url-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    limit: 8*1024, //小于8*1024的会被转为base64地址</span><br><span class="line">                    name: &apos;[name].[hash:10].[ext]&apos;, //name属性指向原来的名称，[hash:8]：取前10位hash值，总共32位</span><br><span class="line">                    esModule: false, //关闭es6模块,使用commonjs模块</span><br><span class="line">                    outputPath: &apos;imgs&apos; //打包后图片资源的输出目录</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                //html中的图片资源</span><br><span class="line">                test: /\.html$/,</span><br><span class="line">                loader:&apos;html-loader&apos;,</span><br><span class="line">                options: &#123;</span><br><span class="line">                    outputPath:&apos;imgs&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = config</span><br></pre></td></tr></table></figure><ol start="4"><li>plugins</li></ol><h4 id="使用html-webpack-plugin"><a href="#使用html-webpack-plugin" class="headerlink" title="使用html-webpack-plugin"></a>使用html-webpack-plugin</h4><p>将打包好的js文件自动注入到 html中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//安装</span><br><span class="line">cnpm i html-webpack-plugin -D</span><br><span class="line"></span><br><span class="line">//引用</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">//使用</span><br><span class="line"></span><br><span class="line">const config = &#123;</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template: &apos;./src/index.html&apos;  //指定html模板</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>mode</li></ol><p>配置中提供 mode 选项：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    mode: &apos;production&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>或者从 CLI 参数中传递：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">webpack --mode=production</span><br></pre></td></tr></table></figure><ol start="6"><li>devServer  配置本地服务器</li></ol><p>Webpack提供了一个可选的本地开发服务器，这个本地服务器基于node.js构建，它是一个单独的组件，在webpack中进行配置之前需要单独安装它作为项目依赖：<br>安装插件 webpack-dev-server ： cnpm i webpack-dev-server -D</p><p>devServer作为webpack配置选项中的一项，以下是它的一些配置选项:</p><p>contentBase ：设置服务器所读取文件的目录，当前我们设置为”./build”<br>port ：设置端口号，如果省略，默认为8080<br>inline ：设置为true，当源文件改变时会自动刷新页面<br>historyApiFallback ：设置为true，所有的跳转将指向index.html</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const webpack = require(&apos;webpack&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: &apos;./bulid&apos;, //服务器运行目录，默认webpack-dev-server会为根文件夹提供本地服务器，</span><br><span class="line">        compress: true, //启用gzip压缩</span><br><span class="line">        port: 3000,  //端口</span><br><span class="line">        open: true   //第一次运行时，自动打开浏览器</span><br><span class="line">        //inline: true , //设置为true,源文件改变时自动刷新页面</span><br><span class="line">        //historyApiFallback: true,  //设置为true，historyFallback能将所有没有做映射的地址都映射到一个入口：index.html中去。</span><br><span class="line">        //hot: true   //热加载，功能：只渲染所改组件的页面效果，不会全部刷新，其他页面数据依然会存在。使用hot,需要配置 hotModule相关模块</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins:[</span><br><span class="line">        //热加载相关</span><br><span class="line">        new webpack.NameModulesPlugin(),</span><br><span class="line">        new webpack.HotModuleReplacementPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>7 .source Map配置   <a href="https://segmentfault.com/a/1190000008315937" target="_blank" rel="noopener">具体配置详见</a></p><p>为方便调试打包后的文件，定位问题，通过配置source map 在打包时生成.map文件，使得打包后的代码可读性更高，更易于调试。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry:&apos;./src/index.js&apos;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: &apos;built.js&apos;,</span><br><span class="line">        path:path.reslove(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: &apos;source-map&apos; // 会生成对于调试的完整的.map文件，但同时也会减慢打包速度</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="基础配置汇总"><a href="#基础配置汇总" class="headerlink" title="基础配置汇总"></a>基础配置汇总</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//引入path</span><br><span class="line">const Path = require(&apos;path&apos;)</span><br><span class="line">//引入 html-webpack-plugin</span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &apos;./src/js/index.js&apos;,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: &apos;built.js&apos;,</span><br><span class="line">        path: Path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">    &#125;,</span><br><span class="line">    //loader</span><br><span class="line">    module:&#123;</span><br><span class="line">        rules:[</span><br><span class="line">            //样式资源</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.css$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.less$/,</span><br><span class="line">                use:[&apos;style-loader&apos;,&apos;css-loader&apos;,&apos;less-loader&apos;]</span><br><span class="line">            &#125;,</span><br><span class="line">            //图片资源</span><br><span class="line">            &#123;</span><br><span class="line">                test: /\.(jpg|png|gif)$/,</span><br><span class="line">                loader: &apos;url-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    limit: 8*1024,</span><br><span class="line">                    esModule:false,</span><br><span class="line">                    name:&apos;[name].[hash:10].[ext]&apos;,</span><br><span class="line">                    outputPath: &apos;imgs&apos;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;  //html图片资源</span><br><span class="line">                test: /\.html$/,</span><br><span class="line">                loader: &apos;html-loader&apos;,</span><br><span class="line">            &#125;,</span><br><span class="line">            //其他资源，字体图标</span><br><span class="line">            &#123;</span><br><span class="line">                //exclude:/\.(js|html|css|jpg|png|gif|less)$/,</span><br><span class="line">                test:/\.(woff2|eot|ttf|woff|svg)$/,</span><br><span class="line">                loader: &apos;file-loader&apos;,</span><br><span class="line">                options:&#123;</span><br><span class="line">                    outputPath:&apos;media&apos;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    mode: &apos;development&apos;,</span><br><span class="line">    plugins:[</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">            template:&apos;./src/index.html&apos;</span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    devServer:&#123;</span><br><span class="line">        contentBase: &apos;./build&apos;,</span><br><span class="line">        compress: true,</span><br><span class="line">        port: 3000,</span><br><span class="line">        open: true</span><br><span class="line">    &#125;,</span><br><span class="line">    devtool: &apos;source-map&apos;  // 会生成对于调试的完整的.map文件，但同时也会减慢打包速度</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;webpack基本配置&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>webpack介绍</title>
    <link href="https://github.com/ywAscend/2020/05/13/webpack/"/>
    <id>https://github.com/ywAscend/2020/05/13/webpack/</id>
    <published>2020-05-13T13:12:59.000Z</published>
    <updated>2020-05-13T13:14:19.017Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>webpack四个核心概念</p><a id="more"></a><ol><li><p>入口：entry</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">webpack入口，指示webpack应该使用哪个模块，来作为构建内部依赖图的开始。</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    entry: &apos;./src/index.js&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>出口：output</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">webpack打包完成后，输出包。包含包名（filename）、输出包的位置(path)。</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line">    const path = require(&apos;path&apos;)</span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        entry: &apos;./src/index&apos;,</span><br><span class="line">        output:&#123;</span><br><span class="line">            filename: &apos;built.js&apos;,  //输出包名为 built.js</span><br><span class="line">            path:path.resolve(__dirname,&apos;build&apos;)  //输出包的位置为当前目录下的 build 文件夹下</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>loader</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">由于webpack自身只能处理js，但实际项目中会依赖以来很多非js类型的文件。而loader提供了webpack处理那些非js文件的能力。</span><br><span class="line">loader可以将所有类型的文件转为webpack能够处理的有效模块。然后再通过webpack的打包能力，进行处理打包。</span><br><span class="line">本质上，webpack loader 将所有类型的文件，转换为应用程序的依赖图可以直接引用的模块。</span><br><span class="line"></span><br><span class="line">loader中通常由两个属性 test、use</span><br><span class="line"></span><br><span class="line">-1) test 属性，用于标识要转换的文件类型</span><br><span class="line">-2）use 属性，表示进行转换时，要使用的loader</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line">    const path = require(&apos;path&apos;)</span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        entry: &apos;./src/index.js&apos;,</span><br><span class="line">        output: &#123;</span><br><span class="line">            filename: &apos;built.js&apos;,</span><br><span class="line">            path: path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        module: &#123;  //loader模块</span><br><span class="line">            rules: [  </span><br><span class="line">                &#123;   //css-loader</span><br><span class="line">                    test: /\.css$/,  </span><br><span class="line">                    use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>插件 plugins</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">loader 被用于转换某些类型的模块，而插件可以用于执行范围更广的任务。是对loader能力的扩充。</span><br><span class="line">插件的范围包括，从打包优化和压缩，一直到重新定义环境中的变量。插件接口功能及其强大，可以用</span><br><span class="line">处理各种各样的任务。</span><br><span class="line"></span><br><span class="line">插件的使用步骤：</span><br><span class="line">安装插件 --&gt; 引用插件（require）--&gt; 使用插件（通常为new一个示例，添加到plugins数组中）</span><br><span class="line"></span><br><span class="line">示例：</span><br><span class="line"></span><br><span class="line">    const path = require(&apos;path&apos;)</span><br><span class="line">    //引入插件 html-webpack-plugin</span><br><span class="line">    const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">    module.exports = &#123;</span><br><span class="line">        entry: &apos;./src/index.js&apos;,</span><br><span class="line">        output: &#123;</span><br><span class="line">            filename: &apos;built.js&apos;,</span><br><span class="line">            path: path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        module:&#123;</span><br><span class="line">            rules: [</span><br><span class="line">                &#123;</span><br><span class="line">                    test: /\.css$/,</span><br><span class="line">                    use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        plugins: [</span><br><span class="line">            new HtmlWebpackPlugin(&#123;</span><br><span class="line">                template: &apos;./src/index.html&apos;</span><br><span class="line">            &#125;)</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p>模式 mode</p></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mode 参数 可选值为 development 或 production，webpack会根据相应的模式进行内置优化</span><br><span class="line"></span><br><span class="line">development: 开发模式，代码不会压缩</span><br><span class="line">productionL: 生产模式，webpack自动压缩代码</span><br></pre></td></tr></table></figure><h4 id="以上全部简单示例"><a href="#以上全部简单示例" class="headerlink" title="以上全部简单示例"></a>以上全部简单示例</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">   //引入插件 html-webpack-plugin</span><br><span class="line">   const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;)</span><br><span class="line"></span><br><span class="line">   module.exports = &#123;</span><br><span class="line">       entry: &apos;./src/index.js&apos;,</span><br><span class="line">       output: &#123;</span><br><span class="line">           filename: &apos;built.js&apos;,</span><br><span class="line">           path: path.resolve(__dirname,&apos;build&apos;)</span><br><span class="line">       &#125;,</span><br><span class="line">       mode: &apos;development&apos;,</span><br><span class="line">       module:&#123;</span><br><span class="line">           rules: [</span><br><span class="line">               &#123;</span><br><span class="line">                   test: /\.css$/,</span><br><span class="line">                   use:[&apos;style-loader&apos;,&apos;css-loader&apos;]</span><br><span class="line">               &#125;</span><br><span class="line">           ]</span><br><span class="line">       &#125;,</span><br><span class="line">       plugins: [</span><br><span class="line">           new HtmlWebpackPlugin(&#123;</span><br><span class="line">               template: &apos;./src/index.html&apos;</span><br><span class="line">           &#125;)</span><br><span class="line">       ]</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;webpack四个核心概念&lt;/p&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/categories/webpack/"/>
    
    
      <category term="webpack" scheme="https://github.com/ywAscend/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>CSS实现自适应正方形</title>
    <link href="https://github.com/ywAscend/2020/03/25/CSS%E5%AE%9E%E7%8E%B0%E8%87%AA%E9%80%82%E5%BA%94%E6%AD%A3%E6%96%B9%E5%BD%A2/"/>
    <id>https://github.com/ywAscend/2020/03/25/CSS%E5%AE%9E%E7%8E%B0%E8%87%AA%E9%80%82%E5%BA%94%E6%AD%A3%E6%96%B9%E5%BD%A2/</id>
    <published>2020-03-25T06:33:27.000Z</published>
    <updated>2020-03-25T07:03:40.013Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>vw单位实现<br>什么是vw、vh、vmin、vmax?<br>先了解一下视口的概念。 在PC端，视口是值浏览器的可视区域；在移动端，则涉及3个视口：Layout Viewport(布局视口)、Visual Viewport(视觉视口)、Idea Viewport(理想视口)。<br>常说的视口，在PC端指的是 浏览器的可视区域；移动端指的是 layout viewport，浏览器内部的可视区域的大小。即 window.innerWidth/window.innerHeight大小，不包含任务标题栏和底部工具栏的浏览器区域大小。</p><a id="more"></a><p>在CSS规范中，视口单位有以下4种：</p><p>1.vw: 1vw等于视口宽度的1%<br>2.vh: 1vh等于视口高度的1%<br>3.vmin: 选取vw和vh中最小的那个<br>4.vmax: 选取vw和vh中最大的那个</p><p>第一种：宽度百分之五十，高度为50vw</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;box&quot;&gt;&lt;/div&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width:50%;</span><br><span class="line">  height:50vw;</span><br><span class="line">  background:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二种: paddig-top或padding-bottom来实现，marging和padding的单位都是相对于宽度</p><p>padding-top实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;box&quot;&gt;&lt;/div&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width:50%;</span><br><span class="line">  height:0;</span><br><span class="line">  padding-top: 50%;</span><br><span class="line">  background:red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>padding-bottom实现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;box&quot;&gt;&lt;/div&gt;</span><br><span class="line">.box&#123;</span><br><span class="line">  width:50%;</span><br><span class="line">  height:0;</span><br><span class="line">  padding-bttom: 50%;</span><br><span class="line">  background:pink;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;vw单位实现&lt;br&gt;什么是vw、vh、vmin、vmax?&lt;br&gt;先了解一下视口的概念。 在PC端，视口是值浏览器的可视区域；在移动端，则涉及3个视口：Layout Viewport(布局视口)、Visual Viewport(视觉视口)、Idea Viewport(理想视口)。&lt;br&gt;常说的视口，在PC端指的是 浏览器的可视区域；移动端指的是 layout viewport，浏览器内部的可视区域的大小。即 window.innerWidth/window.innerHeight大小，不包含任务标题栏和底部工具栏的浏览器区域大小。&lt;/p&gt;
    
    </summary>
    
    
      <category term="前端" scheme="https://github.com/ywAscend/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="前端" scheme="https://github.com/ywAscend/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>判断一个字符串中出现次数最多的字符并统计次数</title>
    <link href="https://github.com/ywAscend/2020/03/25/%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AD%97%E7%AC%A6%E5%B9%B6%E7%BB%9F%E8%AE%A1%E6%AC%A1%E6%95%B0/"/>
    <id>https://github.com/ywAscend/2020/03/25/%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0%E6%9C%80%E5%A4%9A%E7%9A%84%E5%AD%97%E7%AC%A6%E5%B9%B6%E7%BB%9F%E8%AE%A1%E6%AC%A1%E6%95%B0/</id>
    <published>2020-03-25T03:54:36.000Z</published>
    <updated>2020-03-25T04:31:01.095Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>eg； str = ‘abcdeffffgenbggoo’</p><a id="more"></a><p>将字符串转为数组arr，然后利用对象属性，遍历数组arr，将数组arr[i]中的值设为对象obj的属性，并给该属性初始值设为1，没出现一次，对应的属性值加1，这样属性值对应的就是该元素出现的次数了。若对象中，无 arr[i] 属性，则obj添加arr[i] 属性，遍历完成后得到保存 转化后的以数组的 值为对象的key, 出现的次数为 value的 一个obj对象。<br>然后，遍历得到的obj对象，比较每一key对应的value值，当value值最大时，则对应的key即为出现次数最多的字符，value即为出现的次数</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">let str = &apos;abcdeffffgenbfggoo&apos;</span><br><span class="line">function getMaxNumStr (str)&#123;</span><br><span class="line">  let obj = getObj(str)</span><br><span class="line"> </span><br><span class="line">  let strNumber=0,  //最多字符出现的次数</span><br><span class="line">  strItem = &apos;&apos; //出现次数最多的字符</span><br><span class="line">  //遍历obj</span><br><span class="line">  for( let key in obj)&#123;</span><br><span class="line">    if(obj[key]&gt;strNumber)&#123;</span><br><span class="line">      strNumber = obj[key]</span><br><span class="line">      strItem = key</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  console.log(`字符$&#123;strItem&#125;出现次数最多的,出现次数为$&#123;strNumber&#125;次`)</span><br><span class="line">&#125;</span><br><span class="line">//获取数组值对象</span><br><span class="line">function getObj (str)&#123;</span><br><span class="line">  let arr = str.split(&apos;&apos;)</span><br><span class="line">  let json =&#123;&#125;</span><br><span class="line">  for(let i =0;i&lt;arr.length;i++)&#123;</span><br><span class="line">    if(!json[arr[i]])&#123;</span><br><span class="line">      json[arr[i]] =1</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      json[arr[i]]+=1</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return json</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getMaxNumStr(str) //字符f出现次数最多的,出现次数为5次</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;p&gt;eg； str = ‘abcdeffffgenbggoo’&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>数组去重</title>
    <link href="https://github.com/ywAscend/2020/03/25/%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D/"/>
    <id>https://github.com/ywAscend/2020/03/25/%E6%95%B0%E7%BB%84%E5%8E%BB%E9%87%8D/</id>
    <published>2020-03-25T01:40:00.000Z</published>
    <updated>2020-03-25T02:26:10.376Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="set去重"><a href="#set去重" class="headerlink" title="set去重"></a>set去重</h3><p>利用ES6新增数据类型，其特点是接收一个数组或类数组对象，作为参数来初始化数据，且数据不能重复</p><a id="more"></a><p>1.与数组的结构赋值搭配去重</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function newArr ( arr ) &#123;</span><br><span class="line">  return [...new Set(arr)]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.与Array.form 搭配去重</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function newArr (arr) &#123;</span><br><span class="line">  let newAarray = new Set(arr)</span><br><span class="line">  return Array.form(newArray)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="indexOf-去重"><a href="#indexOf-去重" class="headerlink" title="indexOf()去重"></a>indexOf()去重</h3><p>最常见的去重方式：先定义一个空数组，然后调用indexOf方法对原来的数组进行遍历，若 indexOf[arr[i]]返回 -1 则把 arr[i] 放入空数组中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function newArr ( arr ) &#123;</span><br><span class="line">  let newArray = []</span><br><span class="line">  for(let i=0;i&lt;arr.length;i++)&#123;</span><br><span class="line">    if(newArray.indexOf(arr[i]) === -1)&#123;</span><br><span class="line">      newArray.push(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return newArray</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="对象属性去重"><a href="#对象属性去重" class="headerlink" title="对象属性去重"></a>对象属性去重</h3><p>创建一个空对象obj和一个空数组newArray，遍历数组arr，将数组arr[i]中的值设为对象obj的属性，并给该属性初始值设为1，没出现一次，对应的属性值加1，这样属性值对应的就是该元素出现的次数了。若对象中，无 arr[i] 属性，则push到创建的空数组newArray中，同时obj添加arr[i] 属性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function newArr (arr)&#123;</span><br><span class="line">  let obj=&#123;&#125;,newArray=[]</span><br><span class="line">  for (let i=0;i&lt;arr.length;i++)&#123;</span><br><span class="line">    if(!obj[arr[i]])&#123;</span><br><span class="line">      newArray.push(arr[i])</span><br><span class="line">      obj[arr[i]] = 1</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      obj[arr[i]]++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return newArray</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="排序后-相邻去重"><a href="#排序后-相邻去重" class="headerlink" title="排序后,相邻去重"></a>排序后,相邻去重</h3><p>先调用 sort 方法，然后遍历数组，若当前元素与下一个元素相同，则说明重复，不相同则添加到新数组中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function newArr (arr)&#123;</span><br><span class="line">  let newArray =[]</span><br><span class="line">  arr = arr.sort()</span><br><span class="line">  newArray = [arr[0]]</span><br><span class="line">  for(let i =1;i&lt;arr.length;i++)&#123;</span><br><span class="line">    if(arr[i] !== arr[i-1])&#123;</span><br><span class="line">      newArray.push(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return newArray</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="双重循环去重-（方法一）"><a href="#双重循环去重-（方法一）" class="headerlink" title="双重循环去重 （方法一）"></a>双重循环去重 （方法一）</h3><p>获取没重复的最右边的值放入新数组，检测到有重复值时终止当前循环同时，进入顶层的循环进行下一轮判断</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function newArr (arr) &#123;</span><br><span class="line">  let newArray =[]</span><br><span class="line">  for(let i =0; i&lt; arr.length;i++)&#123;</span><br><span class="line">    for(let j = i+1; j&lt; arr.length;j++)&#123;</span><br><span class="line">      if(arr[i] === arr[j])&#123;</span><br><span class="line">        i++;</span><br><span class="line">        j = i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    newArray.push(arr[i])</span><br><span class="line">  &#125;</span><br><span class="line">  console.log(index)</span><br><span class="line">  return newArray</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="双重循环去重-（方法二）"><a href="#双重循环去重-（方法二）" class="headerlink" title="双重循环去重 （方法二）"></a>双重循环去重 （方法二）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function newArr2(arr) &#123;</span><br><span class="line">  for (let i = 0; i &lt; arr.length; i++) &#123;</span><br><span class="line">    for (let j = i + 1; j &lt; arr.length; j++) &#123;</span><br><span class="line">      if (arr[i] == arr[j]) &#123;</span><br><span class="line">        arr.splice(j, 1)</span><br><span class="line">        j--</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; class=&quot;aplayer-secondary-script-marker&quot;&gt;&lt;/script&gt;&lt;script class=&quot;meting-secondary-script-marker&quot; src=&quot;\assets\js\Meting.min.js&quot;&gt;&lt;/script&gt;&lt;h3 id=&quot;set去重&quot;&gt;&lt;a href=&quot;#set去重&quot; class=&quot;headerlink&quot; title=&quot;set去重&quot;&gt;&lt;/a&gt;set去重&lt;/h3&gt;&lt;p&gt;利用ES6新增数据类型，其特点是接收一个数组或类数组对象，作为参数来初始化数据，且数据不能重复&lt;/p&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/categories/JavaScript/"/>
    
    
      <category term="JavaScript" scheme="https://github.com/ywAscend/tags/JavaScript/"/>
    
  </entry>
  
</feed>
